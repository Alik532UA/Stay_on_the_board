<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тест Впливу Логування на Продуктивність</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-panel {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background: #0056b3;
        }
        .button.danger {
            background: #dc3545;
        }
        .button.danger:hover {
            background: #c82333;
        }
        .button.success {
            background: #28a745;
        }
        .button.success:hover {
            background: #218838;
        }
        .results {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin-top: 10px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .status.enabled {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.disabled {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <h1>Тест Впливу Логування на Продуктивність</h1>
    
    <div class="test-panel">
        <h2>Поточний Стан Логування</h2>
        <div id="logging-status" class="status"></div>
        
        <h3>Швидке Керування</h3>
        <button class="button success" onclick="enableLogging()">Увімкнути Логування</button>
        <button class="button danger" onclick="disableLogging()">Вимкнути Логування</button>
        <button class="button" onclick="setLogLevel('ERROR')">Тільки Помилки</button>
        <button class="button" onclick="setLogLevel('WARN')">Помилки + Попередження</button>
        <button class="button" onclick="setLogLevel('INFO')">Всі Крім Debug</button>
        <button class="button" onclick="setLogLevel('DEBUG')">Всі Логи</button>
    </div>
    
    <div class="test-panel">
        <h2>Тест Продуктивності</h2>
        <p>Цей тест вимірює час виконання операцій з різними налаштуваннями логування.</p>
        
        <button class="button" onclick="runPerformanceTest()">Запустити Тест</button>
        <button class="button" onclick="clearResults()">Очистити Результати</button>
        
        <div id="test-results" class="results"></div>
    </div>
    
    <div class="test-panel">
        <h2>Тест Гри</h2>
        <p>Тестування продуктивності з реальною грою.</p>
        
        <button class="button" onclick="testGamePerformance()">Тест Гри</button>
        <button class="button" onclick="openGame()">Відкрити Гру</button>
        
        <div id="game-results" class="results"></div>
    </div>

    <script src="js/utils/logger.js"></script>
    <script>
        // Функції керування логуванням
        function updateStatus() {
            const status = document.getElementById('logging-status');
            const config = Logger.config;
            
            let statusText = `Рівень: ${config.level}\n`;
            statusText += `Швидке вимкнення: ${config.quickDisable ? 'Увімкнено' : 'Вимкнено'}\n`;
            statusText += `Консоль: ${config.enableConsoleOutput ? 'Увімкнено' : 'Вимкнено'}\n`;
            statusText += `Збереження: ${config.enableStorageOutput ? 'Увімкнено' : 'Вимкнено'}\n`;
            statusText += `Кількість логів: ${Logger.logs.length}`;
            
            status.textContent = statusText;
            status.className = `status ${config.quickDisable ? 'disabled' : 'enabled'}`;
        }
        
        function enableLogging() {
            Logger.config.quickDisable = false;
            Logger.config.enableConsoleOutput = true;
            Logger.config.enableStorageOutput = true;
            updateStatus();
        }
        
        function disableLogging() {
            Logger.config.quickDisable = true;
            Logger.config.enableConsoleOutput = false;
            Logger.config.enableStorageOutput = false;
            updateStatus();
        }
        
        function setLogLevel(level) {
            Logger.config.level = level;
            updateStatus();
        }
        
        // Тест продуктивності
        function runPerformanceTest() {
            const results = document.getElementById('test-results');
            let output = '=== ТЕСТ ПРОДУКТИВНОСТІ ===\n\n';
            
            // Тест 1: Без логування
            disableLogging();
            const timeWithoutLogging = measureOperation(() => {
                for (let i = 0; i < 1000; i++) {
                    // Симуляція операцій гри
                    const board = Array(5).fill().map(() => Array(5).fill(0));
                    const moves = calculateMoves(board, 2, 2);
                }
            });
            
            // Тест 2: З логуванням ERROR
            setLogLevel('ERROR');
            enableLogging();
            const timeWithErrorLogging = measureOperation(() => {
                for (let i = 0; i < 1000; i++) {
                    Logger.error('Test error', { iteration: i });
                    const board = Array(5).fill().map(() => Array(5).fill(0));
                    const moves = calculateMoves(board, 2, 2);
                }
            });
            
            // Тест 3: З логуванням INFO
            setLogLevel('INFO');
            const timeWithInfoLogging = measureOperation(() => {
                for (let i = 0; i < 1000; i++) {
                    Logger.info('Test info', { iteration: i });
                    const board = Array(5).fill().map(() => Array(5).fill(0));
                    const moves = calculateMoves(board, 2, 2);
                }
            });
            
            // Тест 4: З логуванням DEBUG
            setLogLevel('DEBUG');
            const timeWithDebugLogging = measureOperation(() => {
                for (let i = 0; i < 1000; i++) {
                    Logger.debug('Test debug', { iteration: i });
                    const board = Array(5).fill().map(() => Array(5).fill(0));
                    const moves = calculateMoves(board, 2, 2);
                }
            });
            
            output += `Без логування: ${timeWithoutLogging.toFixed(2)}ms\n`;
            output += `З ERROR логуванням: ${timeWithErrorLogging.toFixed(2)}ms\n`;
            output += `З INFO логуванням: ${timeWithInfoLogging.toFixed(2)}ms\n`;
            output += `З DEBUG логуванням: ${timeWithDebugLogging.toFixed(2)}ms\n\n`;
            
            output += `Вплив ERROR: +${((timeWithErrorLogging - timeWithoutLogging) / timeWithoutLogging * 100).toFixed(1)}%\n`;
            output += `Вплив INFO: +${((timeWithInfoLogging - timeWithoutLogging) / timeWithoutLogging * 100).toFixed(1)}%\n`;
            output += `Вплив DEBUG: +${((timeWithDebugLogging - timeWithoutLogging) / timeWithoutLogging * 100).toFixed(1)}%\n`;
            
            results.textContent = output;
        }
        
        function measureOperation(operation) {
            const start = performance.now();
            operation();
            const end = performance.now();
            return end - start;
        }
        
        function calculateMoves(board, row, col) {
            const moves = [];
            const directions = [[-1, 0], [1, 0], [0, -1], [0, 1], [-1, -1], [-1, 1], [1, -1], [1, 1]];
            
            for (let [dr, dc] of directions) {
                for (let distance = 1; distance <= 3; distance++) {
                    const newRow = row + dr * distance;
                    const newCol = col + dc * distance;
                    
                    if (newRow >= 0 && newRow < board.length && 
                        newCol >= 0 && newCol < board[0].length) {
                        moves.push({ row: newRow, col: newCol, direction: [dr, dc], distance });
                    }
                }
            }
            
            return moves;
        }
        
        function clearResults() {
            document.getElementById('test-results').textContent = '';
            document.getElementById('game-results').textContent = '';
        }
        
        function testGamePerformance() {
            const results = document.getElementById('game-results');
            let output = '=== ТЕСТ ПРОДУКТИВНОСТІ ГРИ ===\n\n';
            
            // Тест без логування
            disableLogging();
            const timeWithoutLogging = measureOperation(() => {
                simulateGameOperations();
            });
            
            // Тест з логуванням
            enableLogging();
            setLogLevel('INFO');
            const timeWithLogging = measureOperation(() => {
                simulateGameOperations();
            });
            
            output += `Без логування: ${timeWithoutLogging.toFixed(2)}ms\n`;
            output += `З логуванням: ${timeWithLogging.toFixed(2)}ms\n`;
            output += `Вплив логування: +${((timeWithLogging - timeWithoutLogging) / timeWithoutLogging * 100).toFixed(1)}%\n`;
            output += `Кількість логів: ${Logger.logs.length}\n`;
            
            results.textContent = output;
        }
        
        function simulateGameOperations() {
            // Симуляція операцій гри
            for (let i = 0; i < 100; i++) {
                Logger.info('Game operation', { operation: 'move', player: i % 2 + 1 });
                
                // Симуляція оновлення дошки
                const board = Array(5).fill().map(() => Array(5).fill(0));
                board[2][2] = 1;
                
                // Симуляція обчислення ходів
                const moves = calculateMoves(board, 2, 2);
                
                // Симуляція рендерингу
                for (let row = 0; row < board.length; row++) {
                    for (let col = 0; col < board[row].length; col++) {
                        if (moves.some(m => m.row === row && m.col === col)) {
                            Logger.debug('Rendering move', { row, col });
                        }
                    }
                }
            }
        }
        
        function openGame() {
            window.open('index.html', '_blank');
        }
        
        // Ініціалізація
        updateStatus();
    </script>
</body>
</html> 