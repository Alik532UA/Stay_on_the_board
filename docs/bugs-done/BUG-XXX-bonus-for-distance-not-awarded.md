---
status: done
---

# BUG-XXX: –ë–æ–Ω—É—Å –∑–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –Ω–µ –Ω–∞—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è –≤ –≥—Ä—ñ –∑ –∫–æ–º–ø'—é—Ç–µ—Ä–æ–º

## –û–ø–∏—Å –ø—Ä–æ–±–ª–µ–º–∏
–ë–æ–Ω—É—Å –∑–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å (`–ë–æ–Ω—É—Å –∑–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å`) –Ω–µ –Ω–∞—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è –≤ –≥—Ä—ñ –∑ –∫–æ–º–ø'—é—Ç–µ—Ä–æ–º (vs-computer mode), —Ö–æ—á–∞ –ª–æ–≥—ñ–∫–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –±–æ–Ω—É—Å—É –ø—Ä–∞—Ü—é—î –ø—Ä–∞–≤–∏–ª—å–Ω–æ.

## –ö—Ä–æ–∫–∏ –¥–ª—è –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è
1. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –≥—Ä—É –∑ –∫–æ–º–ø'—é—Ç–µ—Ä–æ–º
2. –ó—Ä–æ–±–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ —Ö–æ–¥—ñ–≤ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –±—ñ–ª—å—à–µ 1 –∫–ª—ñ—Ç–∏–Ω–∫–∏
3. –ó–∞–≤–µ—Ä—à–∏—Ç–∏ –≥—Ä—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–∞—Ç–∏—Å–Ω—É–≤—à–∏ "–ó–∞–≤–µ—Ä—à–∏—Ç–∏")
4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π —Ä–∞—Ö—É–Ω–æ–∫

## –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
–ë–æ–Ω—É—Å –∑–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –ø–æ–≤–∏–Ω–µ–Ω –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏—Å—è –≤ –¥–µ—Ç–∞–ª—è—Ö —Ñ—ñ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Ö—É–Ω–∫—É –∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º "–ë–æ–Ω—É—Å –∑–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å: +X".

## –§–∞–∫—Ç–∏—á–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
–ë–æ–Ω—É—Å –∑–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –≤ —Ñ—ñ–Ω–∞–ª—å–Ω–æ–º—É —Ä–∞—Ö—É–Ω–∫—É, —Ö–æ—á–∞ —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ.

## –ü—Ä–∏—á–∏–Ω–∞
–ü—Ä–æ–±–ª–µ–º–∞ –±—É–ª–∞ –≤ –∫—ñ–ª—å–∫–æ—Ö –º—ñ—Å—Ü—è—Ö:

1. **–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ø–æ–ª—è –≤ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö**: `GameState` —Ç–∞ `FinalScore` –Ω–µ –º—ñ—Å—Ç–∏–ª–∏ –ø–æ–ª–µ `distanceBonus`
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—è**: `calculateFinalScore` –Ω–µ –≤–∫–ª—é—á–∞–ª–∞ `distanceBonus` –≤ –∑–∞–≥–∞–ª—å–Ω–∏–π —Ä–∞—Ö—É–Ω–æ–∫
3. **–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `Modal.svelte` –Ω–µ –ø–æ–∫–∞–∑—É–≤–∞–≤ `distanceBonus`
4. **–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—ó**: –§–∞–π–ª–∏ –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—ó –Ω–µ –º—ñ—Å—Ç–∏–ª–∏ –∫–ª—é—á –¥–ª—è `distanceBonus`

## –í–∏—Ä—ñ—à–µ–Ω–Ω—è

### 1. –û–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ–≤
**–§–∞–π–ª**: `src/lib/stores/gameState.ts`
```typescript
export interface GameState {
  // ... existing fields ...
  /** –ë–æ–Ω—É—Å –∑–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å (—Ö–æ–¥–∏ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –±—ñ–ª—å—à–µ 1). */
  distanceBonus?: number;
  // ... existing fields ...
}
```

**–§–∞–π–ª**: `src/lib/services/gameLogicService.ts`
```typescript
export interface FinalScore {
  // ... existing fields ...
  distanceBonus: number;
  // ... existing fields ...
}
```

### 2. –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É —Ñ—ñ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Ö—É–Ω–∫—É
**–§–∞–π–ª**: `src/lib/services/gameLogicService.ts`
```typescript
export function calculateFinalScore(state: GameState): FinalScore {
  const { score, penaltyPoints, boardSize, movesInBlockMode, jumpedBlockedCells, finishedByFinishButton, noMovesBonus, distanceBonus } = state;
  
  // ... existing calculation ...
  
  const totalScore = baseScore + sizeBonus + blockModeBonus + jumpBonus + (distanceBonus || 0) - totalPenalty + (noMovesBonus || 0) + finishBonus;
  
  return {
    // ... existing fields ...
    distanceBonus: distanceBonus || 0,
    totalScore
  };
}
```

### 3. –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É —Ä–∞—Ö—É–Ω–∫—É –∑–∞ —Ö—ñ–¥
**–§–∞–π–ª**: `src/lib/services/gameLogicService.ts`
```typescript
function calculateMoveScore(
  // ... existing parameters ...
): { score: number; penaltyPoints: number; movesInBlockMode: number; jumpedBlockedCells: number; bonusPoints: number; distanceBonus: number } {
  
  let newDistanceBonus = currentState.distanceBonus || 0;
  
  // 5. –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª—ñ–≤ –∑–∞ —Ö–æ–¥–∏ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –±—ñ–ª—å—à–µ 1
  if (distance > 1) {
    newDistanceBonus += 1;
    newBonusPoints += 1;
    console.log(`üéØ calculateMoveScore: –¥–æ–¥–∞—î–º–æ 1 –±–æ–Ω—É—Å–Ω–∏–π –±–∞–ª –∑–∞ —Ö—ñ–¥ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å ${distance}`);
  }
  
  return {
    // ... existing fields ...
    distanceBonus: newDistanceBonus
  };
}
```

### 4. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –≤ –ø–æ—á–∞—Ç–∫–æ–≤–æ–º—É —Å—Ç–∞–Ω—ñ
**–§–∞–π–ª**: `src/lib/stores/gameState.ts`
```typescript
export function createInitialState(config: GameStateConfig = {}): GameState {
  return {
    // ... existing fields ...
    distanceBonus: 0,
    // ... existing fields ...
  };
}
```

### 5. –î–æ–¥–∞–≤–∞–Ω–Ω—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ
**–§–∞–π–ª**: `src/lib/components/Modal.svelte`
```svelte
{#if (($modalState.content as any)?.scoreDetails?.distanceBonus ?? $gameState.distanceBonus ?? 0) > 0}
  <div class="score-detail-row">{$_('modal.scoreDetails.distanceBonus')} <span>+{($modalState.content as any)?.scoreDetails?.distanceBonus ?? $gameState.distanceBonus ?? 0}</span></div>
{/if}
```

### 6. –î–æ–¥–∞–≤–∞–Ω–Ω—è –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—ó
**–§–∞–π–ª–∏**: `src/lib/i18n/*/modal.js`
```javascript
scoreDetails: {
  // ... existing keys ...
  distanceBonus: "–ë–æ–Ω—É—Å –∑–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å:", // Ukrainian
  distanceBonus: "Distance bonus:", // English
  distanceBonus: "Afstand bonus:", // Dutch
  distanceBonus: "Mesafe bonusƒ±:", // Crimean Tatar
  // ... existing keys ...
}
```

### 7. –û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó
–û–Ω–æ–≤–ª–µ–Ω–æ –æ–ø–∏—Å —Å–∏—Å—Ç–µ–º–∏ –±–æ–Ω—É—Å—ñ–≤ —É –≤—Å—ñ—Ö —Ñ–∞–π–ª–∞—Ö –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—ó, —â–æ–± –≤–∫–ª—é—á–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –±–æ–Ω—É—Å –∑–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å.

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- ‚úÖ –ë–æ–Ω—É—Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Ö–æ–¥—ñ–≤ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å > 1
- ‚úÖ –ë–æ–Ω—É—Å –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ `GameState` –¥–ª—è –≥—Ä–∏ –∑ –∫–æ–º–ø'—é—Ç–µ—Ä–æ–º
- ‚úÖ –ë–æ–Ω—É—Å –≤–∫–ª—é—á–∞—î—Ç—å—Å—è –≤ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π —Ä–∞—Ö—É–Ω–æ–∫
- ‚úÖ –ë–æ–Ω—É—Å –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –≤ –º–æ–¥–∞–ª—å–Ω–æ–º—É –≤—ñ–∫–Ω—ñ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –≥—Ä–∏
- ‚úÖ –õ–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∞—Ü—é—î –¥–ª—è –≤—Å—ñ—Ö –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω–∏—Ö –º–æ–≤

## –°—Ç–∞—Ç—É—Å
‚úÖ **–í–∏—Ä—ñ—à–µ–Ω–æ**

–ü—Ä–æ–±–ª–µ–º–∞ –±—É–ª–∞ –ø–æ–≤–Ω—ñ—Å—Ç—é –≤–∏—Ä—ñ—à–µ–Ω–∞:
1. ‚úÖ –î–æ–¥–∞–Ω–æ `distanceBonus` –¥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ–≤ `GameState` —Ç–∞ `FinalScore`
2. ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–æ `calculateFinalScore` –¥–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—è `distanceBonus` –≤ –∑–∞–≥–∞–ª—å–Ω–∏–π —Ä–∞—Ö—É–Ω–æ–∫
3. ‚úÖ –ú–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ `calculateMoveScore` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –Ω–∞–∫–æ–ø–∏—á–µ–Ω–Ω—è `distanceBonus`
4. ‚úÖ –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ `distanceBonus` –≤ `createInitialState`
5. ‚úÖ –î–æ–¥–∞–Ω–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è `distanceBonus` –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ `Modal.svelte`
6. ‚úÖ –î–æ–¥–∞–Ω–æ –∫–ª—é—á—ñ –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—ó –¥–ª—è `distanceBonus` —É –≤—Å—ñ—Ö –º–æ–≤–∞—Ö
7. ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é –ø—Ä–æ —Å–∏—Å—Ç–µ–º—É –±–æ–Ω—É—Å—ñ–≤

## –§–∞–π–ª–∏, —â–æ –±—É–ª–∏ –∑–º—ñ–Ω–µ–Ω—ñ
- `src/lib/stores/gameState.ts`
- `src/lib/services/gameLogicService.ts`
- `src/lib/components/Modal.svelte`
- `src/lib/i18n/uk/modal.js`
- `src/lib/i18n/en/modal.js`
- `src/lib/i18n/nl/modal.js`
- `src/lib/i18n/crh/modal.js` 