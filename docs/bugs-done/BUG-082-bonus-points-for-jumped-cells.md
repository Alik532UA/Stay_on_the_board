---
status: done
---

# BUG-082: –ë–æ–Ω—É—Å–Ω—ñ –±–∞–ª–∏ –∑–∞ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫ –Ω–µ –Ω–∞—Ä–∞—Ö–æ–≤—É—é—Ç—å—Å—è

## –û–ø–∏—Å –ø—Ä–æ–±–ª–µ–º–∏

–í –ª–æ–∫–∞–ª—å–Ω—ñ–π –≥—Ä—ñ –±–æ–Ω—É—Å–Ω—ñ –±–∞–ª–∏ –Ω–∞—Ä–∞—Ö–æ–≤—É–≤–∞–ª–∏—Å—è —Ç—ñ–ª—å–∫–∏ –∑–∞ —Ö–æ–¥–∏ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –±—ñ–ª—å—à–µ 1, –∞–ª–µ –Ω–µ –∑–∞ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫.

### –ê–∫—Ç—É–∞–ª—å–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ë–æ–Ω—É—Å–Ω—ñ –±–∞–ª–∏ –Ω–∞—Ä–∞—Ö–æ–≤—É–≤–∞–ª–∏—Å—è —Ç—ñ–ª—å–∫–∏ –∑–∞ —Ö–æ–¥–∏ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –±—ñ–ª—å—à–µ 1
- –ë–æ–Ω—É—Å–Ω—ñ –±–∞–ª–∏ –∑–∞ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫ –Ω–µ –Ω–∞—Ä–∞—Ö–æ–≤—É–≤–∞–ª–∏—Å—è

### –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ë–æ–Ω—É—Å–Ω—ñ –±–∞–ª–∏ –Ω–∞—Ä–∞—Ö–æ–≤—É—é—Ç—å—Å—è –∑–∞ —Ö–æ–¥–∏ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –±—ñ–ª—å—à–µ 1
- –ë–æ–Ω—É—Å–Ω—ñ –±–∞–ª–∏ –Ω–∞—Ä–∞—Ö–æ–≤—É—é—Ç—å—Å—è –∑–∞ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫
- –ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª—ñ–≤ = –±–æ–Ω—É—Å–∏ –∑–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å + –±–æ–Ω—É—Å–∏ –∑–∞ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è

## –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ–±–ª–µ–º–∏

### –ü—Ä–∏—á–∏–Ω–∞
–í —Ñ—É–Ω–∫—Ü—ñ—ó `calculateMoveScore` –≤ `gameLogicService.ts` –±–æ–Ω—É—Å–Ω—ñ –±–∞–ª–∏ –Ω–∞—Ä–∞—Ö–æ–≤—É–≤–∞–ª–∏—Å—è —Ç—ñ–ª—å–∫–∏ –∑–∞ —Ö–æ–¥–∏ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –±—ñ–ª—å—à–µ 1:

```typescript
// 5. –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª—ñ–≤ –∑–∞ —Ö–æ–¥–∏ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –±—ñ–ª—å—à–µ 1
if (distance > 1) {
  newBonusPoints = distance - 1; // –ë–æ–Ω—É—Å = –≤—ñ–¥—Å—Ç–∞–Ω—å - 1
  console.log(`üéØ calculateMoveScore: –¥–æ–¥–∞—î–º–æ ${newBonusPoints} –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª—ñ–≤ –∑–∞ —Ö—ñ–¥ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å ${distance}`);
}
```

–§—É–Ω–∫—Ü—ñ—è `countJumpedCells` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—ñ–¥—Ä–∞—Ö–æ–≤—É–≤–∞–ª–∞ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±–Ω—É—Ç—ñ –∫–ª—ñ—Ç–∏–Ω–∫–∏, –∞–ª–µ —Ü—ñ –±–∞–ª–∏ –Ω–µ –¥–æ–¥–∞–≤–∞–ª–∏—Å—è –¥–æ `newBonusPoints`.

### –î—É–±–ª—é–≤–∞–Ω–Ω—è –Ω–∞—Ä–∞—Ö—É–≤–∞–Ω–Ω—è
–ö—Ä—ñ–º —Ç–æ–≥–æ, –≤ —Ñ—É–Ω–∫—Ü—ñ—ó `performMove` –±–æ–Ω—É—Å–Ω—ñ –±–∞–ª–∏ –Ω–∞—Ä–∞—Ö–æ–≤—É–≤–∞–ª–∏—Å—è –¥–≤—ñ—á—ñ:
1. –ß–µ—Ä–µ–∑ `scoreChanges.bonusPoints` (—Ç—ñ–ª—å–∫–∏ –∑–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å)
2. –ß–µ—Ä–µ–∑ `scoreChanges.jumpedBlockedCells` (–∑–∞ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è)

## –†—ñ—à–µ–Ω–Ω—è

### 1. –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è `calculateMoveScore`

–ó–º—ñ–Ω–µ–Ω–æ –ª–æ–≥—ñ–∫—É –Ω–∞—Ä–∞—Ö—É–≤–∞–Ω–Ω—è –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª—ñ–≤:

```typescript
// 5. –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª—ñ–≤ –∑–∞ —Ö–æ–¥–∏ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –±—ñ–ª—å—à–µ 1
if (distance > 1) {
  newBonusPoints += distance - 1; // –ë–æ–Ω—É—Å = –≤—ñ–¥—Å—Ç–∞–Ω—å - 1
  console.log(`üéØ calculateMoveScore: –¥–æ–¥–∞—î–º–æ ${distance - 1} –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª—ñ–≤ –∑–∞ —Ö—ñ–¥ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å ${distance}`);
}

// 6. –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª—ñ–≤ –∑–∞ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫
if (jumpedCount > 0) {
  newBonusPoints += jumpedCount; // –ë–æ–Ω—É—Å = –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–µ—Ä–µ—Å—Ç—Ä–∏–±–Ω—É—Ç–∏—Ö –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫
  console.log(`üéØ calculateMoveScore: –¥–æ–¥–∞—î–º–æ ${jumpedCount} –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª—ñ–≤ –∑–∞ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è ${jumpedCount} –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫`);
}
```

### 2. –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –¥—É–±–ª—é–≤–∞–Ω–Ω—è –≤ `performMove`

–í–∏–¥–∞–ª–µ–Ω–æ –æ–∫—Ä–µ–º–µ –Ω–∞—Ä–∞—Ö—É–≤–∞–Ω–Ω—è –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª—ñ–≤ –∑–∞ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è:

```typescript
// –î–æ–¥–∞—î–º–æ –±–æ–Ω—É—Å–Ω—ñ –±–∞–ª–∏ (–≤–∫–ª—é—á–∞—é—Ç—å —è–∫ —Ö–æ–¥–∏ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –±—ñ–ª—å—à–µ 1, —Ç–∞–∫ —ñ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫)
if (scoreChanges.bonusPoints > 0) {
  console.log(`üéØ performMove: –¥–æ–¥–∞—î–º–æ ${scoreChanges.bonusPoints} –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª—ñ–≤ –≥—Ä–∞–≤—Ü—é ${currentPlayer.name} (–≤–∫–ª—é—á–∞—é—Ç—å —Ö–æ–¥–∏ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å > 1 —Ç–∞ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫)`);
  localGameStore.addPlayerBonusPoints(localPlayer.id, scoreChanges.bonusPoints);
}
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä –±–æ–Ω—É—Å–Ω—ñ –±–∞–ª–∏ –Ω–∞—Ä–∞—Ö–æ–≤—É—é—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

### –ü—Ä–∏–∫–ª–∞–¥–∏ –Ω–∞—Ä–∞—Ö—É–≤–∞–Ω–Ω—è:
1. **–•—ñ–¥ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å 1 –±–µ–∑ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è**: 0 –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª—ñ–≤
2. **–•—ñ–¥ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å 2 –±–µ–∑ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è**: 1 –±–æ–Ω—É—Å–Ω–∏–π –±–∞–ª (–∑–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å)
3. **–•—ñ–¥ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å 2 –∑ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è–º 1 –∫–ª—ñ—Ç–∏–Ω–∫–∏**: 2 –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª–∏ (1 –∑–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å + 1 –∑–∞ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è)
4. **–•—ñ–¥ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å 3 –∑ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è–º 2 –∫–ª—ñ—Ç–∏–Ω–æ–∫**: 4 –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª–∏ (2 –∑–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å + 2 –∑–∞ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è)

### –§–æ—Ä–º—É–ª–∞ –Ω–∞—Ä–∞—Ö—É–≤–∞–Ω–Ω—è:
```
–ë–æ–Ω—É—Å–Ω—ñ –±–∞–ª–∏ = (–≤—ñ–¥—Å—Ç–∞–Ω—å - 1) + –∫—ñ–ª—å–∫—ñ—Å—Ç—å_–ø–µ—Ä–µ—Å—Ç—Ä–∏–±–Ω—É—Ç–∏—Ö_–∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏—Ö_–∫–ª—ñ—Ç–∏–Ω–æ–∫
```

## –§–∞–π–ª–∏, —â–æ –±—É–ª–∏ –∑–º—ñ–Ω–µ–Ω—ñ

- `src/lib/services/gameLogicService.ts` - –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ –ª–æ–≥—ñ–∫—É –Ω–∞—Ä–∞—Ö—É–≤–∞–Ω–Ω—è –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª—ñ–≤

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω–æ –≤ –ª–æ–∫–∞–ª—å–Ω—ñ–π –≥—Ä—ñ:
- ‚úÖ –ë–æ–Ω—É—Å–Ω—ñ –±–∞–ª–∏ –Ω–∞—Ä–∞—Ö–æ–≤—É—é—Ç—å—Å—è –∑–∞ —Ö–æ–¥–∏ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –±—ñ–ª—å—à–µ 1
- ‚úÖ –ë–æ–Ω—É—Å–Ω—ñ –±–∞–ª–∏ –Ω–∞—Ä–∞—Ö–æ–≤—É—é—Ç—å—Å—è –∑–∞ –ø–µ—Ä–µ—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫
- ‚úÖ –ù–µ–º–∞—î –¥—É–±–ª—é–≤–∞–Ω–Ω—è –Ω–∞—Ä–∞—Ö—É–≤–∞–Ω–Ω—è
- ‚úÖ –ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –±–æ–Ω—É—Å–Ω–∏—Ö –±–∞–ª—ñ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–∞

## –°—Ç–∞—Ç—É—Å

‚úÖ **–í–ò–ü–†–ê–í–õ–ï–ù–û** - 2025-01-30 