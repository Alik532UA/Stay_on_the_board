---
status: done
---

# Тип: BUG
# Статус: Виконано
# Назва: Center-info очищається після ходу гравця в локальній грі
# Мета: Забезпечити, щоб center-info показував останній хід гравця до тих пір, поки наступний гравець не почне вибирати свій хід
# Опис: В локальній грі після ходу гравця center-info очищається, хоча має показувати останній хід гравця до початку ходу наступного гравця.

---

## Кроки для відтворення
1. Запустити локальну гру з кількома гравцями
2. Зробити хід першим гравцем
3. Подивитися на center-info

## Актуальний результат
- center-info очищається після ходу гравця

## Очікуваний результат
- center-info показує останній хід гравця до тих пір, поки наступний гравець не почне вибирати свій хід

---

## Аналіз проблеми

### Причина
В локальній грі після ходу гравця:
1. `playerInputStore` очищається (встановлюється `selectedDirection: null, selectedDistance: null`)
2. `lastComputerMove` завжди `null` в локальній грі
3. Тому `center-info` стає порожнім

### Рішення
Модифікувати `centerInfoUtil.ts` для підтримки `lastPlayerMove` в локальних іграх:

1. **Додати параметр `lastPlayerMove`** до функції `getCenterInfoState`
2. **Додати логіку відображення** останнього ходу гравця, коли немає вибраного ходу
3. **Оновити всі компоненти**, які використовують `getCenterInfoState`

---

## Зміни в коді

### src/lib/utils/centerInfoUtil.ts
- Додано параметр `lastPlayerMove` до функції `getCenterInfoState`
- Додано логіку відображення останнього ходу гравця для локальних ігор

### src/lib/components/widgets/ControlsPanelWidget.svelte
- Додано імпорт `lastPlayerMove`
- Передано `lastPlayerMove` в `getCenterInfoState`

### src/components/GameControls.svelte
- Додано імпорт `lastPlayerMove`
- Передано `lastPlayerMove` в `getCenterInfoState`

---

## Тестування

### Тест 1: Локальна гра
1. Запустити локальну гру з 2+ гравцями
2. Зробити хід першим гравцем
3. **Очікуваний результат:** center-info показує останній хід гравця
4. Почати вибирати хід другим гравцем
5. **Очікуваний результат:** center-info показує вибраний хід другого гравця

### Тест 2: Гра проти комп'ютера
1. Запустити гру проти комп'ютера
2. Зробити хід гравцем
3. **Очікуваний результат:** center-info показує хід комп'ютера
4. Зробити ще один хід гравцем
5. **Очікуваний результат:** center-info показує вибраний хід гравця

---

## Додаткові завдання
- [x] Перевірити, що зміни не впливають на гру проти комп'ютера
- [x] Перевірити, що логіка працює коректно в локальних іграх
- [x] Додати відповідну документацію 