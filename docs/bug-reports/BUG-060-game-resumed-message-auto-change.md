---
id: BUG-060
title: Повідомлення "Гру продовжено" автоматично змінюється на "Ваша черга робити хід"
status: fixed
---

### Опис

Повідомлення "Гру продовжено, фігура знаходиться на тому ж місці де вона була до завершення зупинки" автоматично змінюється на "Ваша черга робити хід" через деякий час. Повідомлення про відновлення гри повинно залишатися постійним і включати інформацію про те, що черга гравця.

### Кроки для відтворення

1. Продовжити гру після модального вікна "Суперник у пастці!"
2. Спостерігати за повідомленням в game-info-content
3. Актуальний результат: повідомлення автоматично змінюється на "Ваша черга робити хід"
4. Очікуваний результат: повідомлення "Гру продовжено" залишається постійним

### Причина проблеми

В `GameInfoWidget.svelte` був код, який автоматично скидав `wasResumed: false` через 3 секунди після показу повідомлення "Гру продовжено". Це призводило до автоматичної зміни повідомлення на "Ваша черга робити хід".

### Виправлення

**Знайдено та виправлено основну причину проблеми:**

1. **Видалено автоматичне скидання `wasResumed`** в `GameInfoWidget.svelte`:
   ```typescript
   // Було (видалено):
   $: if ($gameState.wasResumed) {
     setTimeout(() => {
       gameState.update(state => ({ ...state, wasResumed: false }));
     }, 3000); // Показуємо повідомлення 3 секунди
   }
   ```

2. **Спрощено логіку стану `wasResumed`:**
   ```typescript
   // Було:
   if ($gameState.wasResumed && !$lastComputerMove) return 'wasResumed';
   
   // Стало:
   if ($gameState.wasResumed) return 'wasResumed';
   ```

3. **Оновлено логіку в `getMessageForState()`:**
   ```typescript
   // Було:
   } else if ($gameState.wasResumed && !$lastComputerMove) {
   
   // Стало:
   } else if ($gameState.wasResumed) {
   ```

4. **Додано правильне скидання `wasResumed` після ходів:**
   ```typescript
   // В _processPlayerMove після успішного ходу гравця:
   if (currentState.wasResumed) {
     await stateManager.applyChanges(
       'RESET_WAS_RESUMED',
       { wasResumed: false },
       'Resetting wasResumed after successful player move'
     );
   }
   
   // В _triggerComputerMove після успішного ходу комп'ютера:
   if (currentState.wasResumed) {
     await stateManager.applyChanges(
       'RESET_WAS_RESUMED_AFTER_COMPUTER_MOVE',
       { wasResumed: false },
       'Resetting wasResumed after successful computer move'
     );
   }
   ```

5. **Оновлено текст повідомлення `gameResumed`** в усіх мовних файлах:
   ```javascript
   // Було:
   gameResumed: "Гру продовжено, фігура знаходиться на тому ж місці де вона була до завершення зупинки"
   
   // Стало:
   gameResumed: "Гру продовжено, фігура знаходиться на тому ж місці де вона була до зупинки.\nВаша черга робити хід"
   ```

### Результат

Тепер повідомлення "Гру продовжено, фігура знаходиться на тому ж місці де вона була до зупинки.\nВаша черга робити хід" залишається постійним до наступного ходу гравця або комп'ютера, і не змінюється автоматично через час. Повідомлення тепер включає інформацію про те, що черга гравця та відображається на двох рядках для кращої читабельності.

### Технічні деталі

- **Проблема:** Автоматичне скидання `wasResumed: false` через 3 секунди
- **Рішення:** Видалено код автоматичного скидання, `wasResumed` тепер скидається тільки після успішних ходів гравця або комп'ютера
- **Вплив:** Повідомлення "Гру продовжено" залишається постійним до наступного ходу
- **Додатково:** Оновлено текст повідомлення, щоб включити інформацію про чергу гравця та додано перенос рядка для кращої читабельності 