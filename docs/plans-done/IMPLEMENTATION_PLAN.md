# –¢–∏–ø: –ü–ª–∞–Ω
# –°—Ç–∞—Ç—É—Å: –í–∏–∫–æ–Ω–∞–Ω–æ
# –ù–∞–∑–≤–∞: –î–µ—Ç–∞–ª—å–Ω–∏–π –ø–ª–∞–Ω —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø–æ–∫—Ä–∞—â–µ–Ω—å –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏
# –û–ø–∏—Å: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–π –ø–æ–∫—Ä–æ–∫–æ–≤–∏–π –ø–ª–∞–Ω –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è —Å—É—á–∞—Å–Ω–∏—Ö –ø—Ä–∏–Ω—Ü–∏–ø—ñ–≤ —Ç–∞ –ø–∞—Ç–µ—Ä–Ω—ñ–≤ —É –∫–æ–¥–æ–≤—É –±–∞–∑—É Stay on the Board. –ú—ñ—Å—Ç–∏—Ç—å –≤—Å—ñ –µ—Ç–∞–ø–∏, —á–µ–∫–ª—ñ—Å—Ç–∏ —Ç–∞ –ø—ñ–¥—Å—É–º–∫–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.

## üéØ –ú–µ—Ç–∞
–ü–æ—Å—Ç—É–ø–æ–≤–æ –≤–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ —Å—É—á–∞—Å–Ω—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏ —Ç–∞ –ø–∞—Ç–µ—Ä–Ω–∏ –≤ —ñ—Å–Ω—É—é—á—É –≤–∞–Ω—ñ–ª—å–Ω—É JS-–∫–æ–¥–æ–≤—É –±–∞–∑—É, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ —ó—ó –±—ñ–ª—å—à —Å—Ç–∞–±—ñ–ª—å–Ω–æ—é, –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–æ—é —Ç–∞ –ª–µ–≥–∫–æ—é –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏.

## üöÄ –§–∞–∑–∞ 1: –¢–∏–ø—ñ–∑–∞—Ü—ñ—è —Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è (1-2 –º—ñ—Å—è—Ü—ñ)

### üìä –ê–Ω–∞–ª—ñ–∑ –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Å—Ç–∞–Ω—É
–ü—Ä–æ–µ–∫—Ç –≤–∂–µ –º–∞—î –¥–æ—Å–∏—Ç—å —Ä–æ–∑–≤–∏–Ω–µ–Ω—É –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É –∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏, State Manager, —Ç–∞ —ñ–Ω—à–∏–º–∏ —Å—É—á–∞—Å–Ω–∏–º–∏ –ø–∞—Ç–µ—Ä–Ω–∞–º–∏. –û–¥–Ω–∞–∫ —î –∫—ñ–ª—å–∫–∞ –∫–ª—é—á–æ–≤–∏—Ö –Ω–∞–ø—Ä—è–º–∫—ñ–≤ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è:

#### ‚úÖ –©–æ –≤–∂–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –¥–æ–±—Ä–µ:
1. **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞** - –≤—Å—ñ –æ—Å–Ω–æ–≤–Ω—ñ UI –µ–ª–µ–º–µ–Ω—Ç–∏ –≤–∏–Ω–µ—Å–µ–Ω—ñ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏
2. **State Management** - —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç–∞–Ω–æ–º –∑ –ø—ñ–¥–ø–∏—Å–∫–æ—é
3. **View Manager** - —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –º—ñ–∂ –µ–∫—Ä–∞–Ω–∞–º–∏
4. **DOM Utilities** - –±–∞–≥–∞—Ç–∏–π –Ω–∞–±—ñ—Ä —É—Ç–∏–ª—ñ—Ç –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ DOM
5. **–ú–æ–¥—É–ª—å–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - –∫–æ–¥ —Ä–æ–∑–¥—ñ–ª–µ–Ω–∏–π –Ω–∞ –ª–æ–≥—ñ—á–Ω—ñ –º–æ–¥—É–ª—ñ

#### ‚ö†Ô∏è –û–±–ª–∞—Å—Ç—ñ –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è:
1. **–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å —Å–∏—Å—Ç–µ–º–∏ –ø–æ–¥—ñ–π** - –Ω–µ–º–∞—î —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ–≥–æ Event Bus
2. **–û–±–º–µ–∂–µ–Ω–∞ —Ç–∏–ø—ñ–∑–∞—Ü—ñ—è** - –≤—ñ–¥—Å—É—Ç–Ω—ñ–π TypeScript –∞–±–æ JSDoc
3. **–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –∫–µ—à—É–≤–∞–Ω–Ω—è** - –Ω–µ–º–∞—î —Å–∏—Å—Ç–µ–º–∏ –∫–µ—à—É–≤–∞–Ω–Ω—è DOM –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
4. **–û–±–º–µ–∂–µ–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è** - –≤—ñ–¥—Å—É—Ç–Ω—ñ unit —Ç–µ—Å—Ç–∏
5. **–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ª–æ–≥—É–≤–∞–Ω–Ω—è** - –Ω–µ–º–∞—î —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏ –ª–æ–≥—É–≤–∞–Ω–Ω—è

### 1.1 JSDoc –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

**–§–∞–π–ª–∏ –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:**
- `js/state-manager.js`
- `js/components/base-component.js`
- `js/view-manager.js`
- `js/game-logic-improved.js`
- `js/utils/dom-utils.js`

**–ü—Ä–∏–∫–ª–∞–¥ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó:**
```javascript
/**
 * –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä —Å—Ç–∞–Ω—É –¥–æ–¥–∞—Ç–∫—É
 * @class StateManager
 */
class StateManager {
    /**
     * –°—Ç–≤–æ—Ä—é—î –Ω–æ–≤–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä StateManager
     * @constructor
     */
    constructor() {
        /** @type {Object} –ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω –¥–æ–¥–∞—Ç–∫—É */
        this.state = { /* ... */ };
        
        /** @type {Map<string, Map<number, Function>>} –ü—ñ–¥–ø–∏—Å–Ω–∏–∫–∏ –Ω–∞ –∑–º—ñ–Ω–∏ —Å—Ç–∞–Ω—É */
        this.subscribers = new Map();
    }
    
    /**
     * –û—Ç—Ä–∏–º—É—î –∑–Ω–∞—á–µ–Ω–Ω—è –∑—ñ —Å—Ç–∞–Ω—É –∑–∞ —à–ª—è—Ö–æ–º
     * @param {string} [path] - –®–ª—è—Ö –¥–æ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 'game.points')
     * @returns {*} –ó–Ω–∞—á–µ–Ω–Ω—è –∑—ñ —Å—Ç–∞–Ω—É
     * @example
     * // –û—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Å—å —Å—Ç–∞–Ω
     * const state = stateManager.getState();
     * 
     * // –û—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å
     * const points = stateManager.getState('game.points');
     */
    getState(path = null) {
        // –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è
    }
    
    /**
     * –í—Å—Ç–∞–Ω–æ–≤–ª—é—î –∑–Ω–∞—á–µ–Ω–Ω—è –≤ —Å—Ç–∞–Ω—ñ
     * @param {string} path - –®–ª—è—Ö –¥–æ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ
     * @param {*} value - –ù–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è
     * @returns {boolean} –ß–∏ —É—Å–ø—ñ—à–Ω–æ –æ–Ω–æ–≤–ª–µ–Ω–æ
     * @throws {Error} –Ø–∫—â–æ —à–ª—è—Ö –Ω–µ–¥—ñ–π—Å–Ω–∏–π
     */
    setState(path, value) {
        // –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è
    }
}
```

### 1.2 TypeScript definitions

**–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª:** `js/types.d.ts`

```typescript
// –¢–∏–ø–∏ –¥–ª—è State Manager
export interface AppState {
    settings: SettingsState;
    game: GameState;
    ui: UIState;
}

export interface SettingsState {
    language: 'uk' | 'en' | 'nl' | 'crh';
    theme: 'light' | 'dark';
    style: 'classic' | 'peak' | 'cs2' | 'glass' | 'material';
    speechEnabled: boolean;
    showBoard: boolean;
    showMoves: boolean;
    blockedMode: boolean;
}

export interface GameState {
    isActive: boolean;
    board: number[][];
    currentPlayer: 1 | 2;
    points: number;
    selectedDirection: string | null;
    selectedDistance: number | null;
    blockedCells: Array<{row: number, col: number}>;
    availableMoves: Array<{row: number, col: number}>;
    showingAvailableMoves: boolean;
    gameMode: 'vsComputer' | 'localTwoPlayer' | 'online' | null;
    playerNames: { p1: string; p2: string };
    boardSize: number;
    selectedMove: any;
    moveConfirmed: boolean;
    noMoves: boolean;
    gameHistory: any[];
    lastMove: any;
}

export interface UIState {
    currentView: 'mainMenu' | 'game' | 'settings';
    modal: {
        isOpen: boolean;
        title: string;
        content: string;
        buttons: Array<{text: string; action: string; primary?: boolean}>;
    };
    topControls: {
        isVisible: boolean;
    };
    loading: boolean;
    error: string | null;
}

// –¢–∏–ø–∏ –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
export interface ComponentOptions {
    [key: string]: any;
}

export interface BaseComponent {
    element: HTMLElement;
    options: ComponentOptions;
    subscriptions: Array<() => void>;
    eventListeners: Map<string, {element: HTMLElement; event: string; handler: Function}>;
    isDestroyed: boolean;
    renderCount: number;
}

// –¢–∏–ø–∏ –¥–ª—è –ø–æ–¥—ñ–π
export interface GameEvent {
    type: string;
    data: any;
    timestamp: number;
}

// –¢–∏–ø–∏ –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
export interface ValidationRule {
    test: (value: any) => boolean;
    message: string;
}

export interface ValidationResult {
    isValid: boolean;
    errors: string[];
}
```

### 1.3 –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ç–∏–ø—ñ–≤ –ø—ñ–¥ —á–∞—Å —Ä–æ–∑—Ä–æ–±–∫–∏

**–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª:** `js/type-checker.js`

```javascript
/**
 * –ü—Ä–æ—Å—Ç–∏–π –≤–∞–ª—ñ–¥–∞—Ç–æ—Ä —Ç–∏–ø—ñ–≤ –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏
 */
class TypeChecker {
    static isDevelopment = process.env.NODE_ENV === 'development';
    
    /**
     * –ü–µ—Ä–µ–≤—ñ—Ä—è—î —Ç–∏–ø –∑–Ω–∞—á–µ–Ω–Ω—è
     * @param {*} value - –ó–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
     * @param {string} expectedType - –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ç–∏–ø
     * @param {string} context - –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
     */
    static checkType(value, expectedType, context = '') {
        if (!this.isDevelopment) return;
        
        let actualType = typeof value;
        
        if (actualType === 'object' && value === null) {
            actualType = 'null';
        } else if (Array.isArray(value)) {
            actualType = 'array';
        }
        
        if (actualType !== expectedType) {
            console.warn(`Type mismatch in ${context}: expected ${expectedType}, got ${actualType}`, value);
        }
    }
    
    /**
     * –ü–µ—Ä–µ–≤—ñ—Ä—è—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ–±'—î–∫—Ç–∞
     * @param {Object} obj - –û–±'—î–∫—Ç –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
     * @param {Object} schema - –°—Ö–µ–º–∞ –æ–±'—î–∫—Ç–∞
     * @param {string} context - –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
     */
    static checkSchema(obj, schema, context = '') {
        if (!this.isDevelopment) return;
        
        for (const [key, expectedType] of Object.entries(schema)) {
            if (obj.hasOwnProperty(key)) {
                this.checkType(obj[key], expectedType, `${context}.${key}`);
            } else {
                console.warn(`Missing property ${key} in ${context}`);
            }
        }
    }
}

// –ï–∫—Å–ø–æ—Ä—Ç –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
if (typeof module !== 'undefined' && module.exports) {
    module.exports = TypeChecker;
} else {
    window.TypeChecker = TypeChecker;
}

## üöÄ –§–∞–∑–∞ 3: –°–∏—Å—Ç–µ–º–∞ –∫–µ—à—É–≤–∞–Ω–Ω—è - –°–ï–†–ï–î–ù–Ü–ô –ü–†–Ü–û–†–ò–¢–ï–¢ (1-2 —Ç–∏–∂–Ω—ñ)

### üéØ –ú–µ—Ç–∞
–û–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —á–µ—Ä–µ–∑ –∫–µ—à—É–≤–∞–Ω–Ω—è DOM –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ —Ç–∞ –≤–∞–∂–∫–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å.

### ‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏
- –®–≤–∏–¥—à–∏–π –¥–æ—Å—Ç—É–ø –¥–æ DOM –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
- –ó–º–µ–Ω—à–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ DOM –∑–∞–ø–∏—Ç—ñ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è –∫–µ—à—É
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### 3.1 DOM Cache Manager

**–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª:** `js/utils/cache-manager.js`

```javascript
/**
 * –ö–µ—à –¥–ª—è DOM-–µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –æ—á–∏—â–µ–Ω–Ω—è–º
 */
class DOMCache {
    constructor(options = {}) {
        const {
            maxSize = 100,
            ttl = 5 * 60 * 1000, // 5 —Ö–≤–∏–ª–∏–Ω
            autoCleanup = true
        } = options;
        
        this.cache = new Map();
        this.maxSize = maxSize;
        this.ttl = ttl;
        this.autoCleanup = autoCleanup;
        this.hits = 0;
        this.misses = 0;
        
        if (this.autoCleanup) {
            this.startAutoCleanup();
        }
    }
    
    /**
     * –û—Ç—Ä–∏–º—É—î –µ–ª–µ–º–µ–Ω—Ç –∑ –∫–µ—à—É –∞–±–æ DOM
     * @param {string} selector - CSS —Å–µ–ª–µ–∫—Ç–æ—Ä
     * @param {Element} [context] - –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—à—É–∫—É
     * @returns {Element|null} DOM –µ–ª–µ–º–µ–Ω—Ç
     */
    get(selector, context = document) {
        const key = this.getCacheKey(selector, context);
        
        if (this.cache.has(key)) {
            const cached = this.cache.get(key);
            
            if (Date.now() - cached.timestamp > this.ttl) {
                this.cache.delete(key);
                this.misses++;
            } else if (this.isElementValid(cached.element)) {
                this.hits++;
                return cached.element;
            } else {
                this.cache.delete(key);
                this.misses++;
            }
        } else {
            this.misses++;
        }
        
        const element = context.querySelector(selector);
        if (element) {
            this.set(key, element);
        }
        
        return element;
    }
    
    /**
     * –û—Ç—Ä–∏–º—É—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–µ—à—É
     * @returns {Object} –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
     */
    getStats() {
        const totalRequests = this.hits + this.misses;
        const hitRate = totalRequests > 0 ? (this.hits / totalRequests) * 100 : 0;
        
        return {
            size: this.cache.size,
            maxSize: this.maxSize,
            hits: this.hits,
            misses: this.misses,
            hitRate: Math.round(hitRate * 100) / 100
        };
    }
}
```

## üöÄ –§–∞–∑–∞ 4: –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥—É–≤–∞–Ω–Ω—è - –°–ï–†–ï–î–ù–Ü–ô –ü–†–Ü–û–†–ò–¢–ï–¢ (1-2 —Ç–∏–∂–Ω—ñ)

### üéØ –ú–µ—Ç–∞
–¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –¥–µ–±–∞–≥—É —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –¥–æ–¥–∞—Ç–∫—É.

### ‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏
- –°—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ –ª–æ–≥–∏
- –†—ñ–∑–Ω—ñ —Ä—ñ–≤–Ω—ñ –ª–æ–≥—É–≤–∞–Ω–Ω—è
- –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ localStorage
- –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è —Ç–∞ –ø–æ—à—É–∫

### 4.1 Logger

**–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª:** `js/utils/logger.js`

```javascript
/**
 * –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥—É–≤–∞–Ω–Ω—è
 */
class Logger {
    static levels = { ERROR: 0, WARN: 1, INFO: 2, DEBUG: 3 };
    
    static config = {
        level: process.env.NODE_ENV === 'development' ? 'DEBUG' : 'ERROR',
        maxLogs: 1000,
        persistToStorage: true,
        sendToServer: false
    };
    
    static logs = [];
    
    /**
     * –õ–æ–≥—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
     * @param {string} level - –†—ñ–≤–µ–Ω—å –ª–æ–≥—É–≤–∞–Ω–Ω—è
     * @param {string} message - –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
     * @param {Object} data - –î–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∞–Ω—ñ
     */
    static log(level, message, data = {}) {
        if (this.levels[level] > this.levels[this.config.level]) {
            return;
        }
        
        const logEntry = {
            level,
            message,
            data,
            timestamp: new Date().toISOString(),
            id: this.generateLogId()
        };
        
        this.logs.push(logEntry);
        
        if (this.logs.length > this.config.maxLogs) {
            this.logs.shift();
        }
        
        this.outputToConsole(logEntry);
        
        if (this.config.persistToStorage) {
            this.saveToStorage(logEntry);
        }
    }
    
    static error(message, data = {}) { this.log('ERROR', message, data); }
    static warn(message, data = {}) { this.log('WARN', message, data); }
    static info(message, data = {}) { this.log('INFO', message, data); }
    static debug(message, data = {}) { this.log('DEBUG', message, data); }
}
```

## üöÄ –§–∞–∑–∞ 5: –°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è - –í–ò–°–û–ö–ò–ô –ü–†–Ü–û–†–ò–¢–ï–¢ (3-4 —Ç–∏–∂–Ω—ñ)

### üéØ –ú–µ—Ç–∞
–î–æ–¥–∞—Ç–∏ unit —Ç–µ—Å—Ç–∏ –¥–ª—è –≤—Å—ñ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ–π.

### ‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ
- –†–µ–≥—Ä–µ—Å—ñ–π–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç–∏
- –ë–µ–∑–ø–µ—á–Ω—ñ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∏

### 5.1 Unit —Ç–µ—Å—Ç–∏

**–°—Ç–≤–æ—Ä–∏—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é:** `tests/unit/`

```javascript
/**
 * Unit —Ç–µ—Å—Ç–∏ –¥–ª—è StateManager
 */
describe('StateManager', () => {
    let stateManager;
    
    beforeEach(() => {
        stateManager = new StateManager();
    });
    
    afterEach(() => {
        stateManager = null;
    });
    
    test('should initialize with default state', () => {
        const state = stateManager.getState();
        expect(state.settings.language).toBe('uk');
        expect(state.game.isActive).toBe(false);
    });
    
    test('should update state correctly', () => {
        stateManager.setState('game.points', 10);
        expect(stateManager.getState('game.points')).toBe(10);
    });
    
    test('should notify subscribers', () => {
        const mockCallback = jest.fn();
        stateManager.subscribe('game.points', mockCallback);
        stateManager.setState('game.points', 15);
        expect(mockCallback).toHaveBeenCalledWith(15);
    });
});
```

## üöÄ –§–∞–∑–∞ 6: –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ - –°–ï–†–ï–î–ù–Ü–ô –ü–†–Ü–û–†–ò–¢–ï–¢ (2-3 —Ç–∏–∂–Ω—ñ)

### üéØ –ú–µ—Ç–∞
–ü–æ–∫—Ä–∞—â–∏—Ç–∏ —à–≤–∏–¥–∫—ñ—Å—Ç—å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—É —Ç–∞ –≤—ñ–¥–≥—É–∫ –¥–æ–¥–∞—Ç–∫—É.

### ‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏
- –®–≤–∏–¥—à–∏–π UI
- –ú–µ–Ω—à–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è CPU
- –ö—Ä–∞—â–∏–π UX
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —Å–ª–∞–±–∫–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤

### 6.1 –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

1. **Virtual Scrolling** –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö —Å–ø–∏—Å–∫—ñ–≤
2. **Lazy Loading** –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
3. **Debouncing** –ø–æ–¥—ñ–π
4. **–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –∞–Ω—ñ–º–∞—Ü—ñ–π**
5. **–ú–µ–º–æ—ñ–∑–∞—Ü—ñ—è** –≤–∞–∂–∫–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å

## üöÄ –§–∞–∑–∞ 7: –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏ - –ù–ò–ó–¨–ö–ò–ô –ü–†–Ü–û–†–ò–¢–ï–¢ (1-2 —Ç–∏–∂–Ω—ñ)

### üéØ –ú–µ—Ç–∞
–ó–±–∏—Ä–∞—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫—É –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

### ‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏
- –†–æ–∑—É–º—ñ–Ω–Ω—è –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- –í–∏—è–≤–ª–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º
- –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è UX
- A/B —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### 7.1 Analytics

**–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª:** `js/utils/analytics.js`

```javascript
/**
 * –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏
 */
class Analytics {
    constructor() {
        this.events = [];
        this.sessionId = this.generateSessionId();
    }
    
    /**
     * –í—ñ–¥—Å—Ç–µ–∂—É—î –ø–æ–¥—ñ—é
     * @param {string} event - –ù–∞–∑–≤–∞ –ø–æ–¥—ñ—ó
     * @param {Object} data - –î–∞–Ω—ñ –ø–æ–¥—ñ—ó
     */
    track(event, data = {}) {
        const eventData = {
            event,
            data,
            timestamp: Date.now(),
            sessionId: this.sessionId,
            url: window.location.href
        };
        
        this.events.push(eventData);
        
        // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∞–±–æ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –ª–æ–∫–∞–ª—å–Ω–æ
        this.sendToServer(eventData);
    }
    
    /**
     * –í—ñ–¥—Å—Ç–µ–∂—É—î –ø–æ–º–∏–ª–∫—É
     * @param {Error} error - –û–±'—î–∫—Ç –ø–æ–º–∏–ª–∫–∏
     */
    trackError(error) {
        this.track('error', {
            message: error.message,
            stack: error.stack,
            type: error.name
        });
    }
}
```

## üìä –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

### üü¢ –í–ò–°–û–ö–ò–ô –ü–†–Ü–û–†–ò–¢–ï–¢ (1-3 –º—ñ—Å—è—Ü—ñ)
1. **–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥—ñ–π (Event System)** - —Ä–æ–∑–≤'—è–∑—É–≤–∞–Ω–Ω—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
2. **–°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è** - –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ
3. **–ü–æ–∫—Ä–∞—â–µ–Ω–∞ —Ç–∏–ø—ñ–∑–∞—Ü—ñ—è** - –∑–º–µ–Ω—à–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫

### üü° –°–ï–†–ï–î–ù–Ü–ô –ü–†–Ü–û–†–ò–¢–ï–¢ (3-6 –º—ñ—Å—è—Ü—ñ–≤)
4. **–°–∏—Å—Ç–µ–º–∞ –∫–µ—à—É–≤–∞–Ω–Ω—è** - –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
5. **–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥—É–≤–∞–Ω–Ω—è** - –ø–æ–ª–µ–≥—à–µ–Ω–Ω—è –¥–µ–±–∞–≥—É
6. **–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ** - —à–≤–∏–¥—à–∏–π UI

### üî¥ –ù–ò–ó–¨–ö–ò–ô –ü–†–Ü–û–†–ò–¢–ï–¢ (6+ –º—ñ—Å—è—Ü—ñ–≤)
7. **–°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏** - —Ä–æ–∑—É–º—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
8. **–î–æ–¥–∞—Ç–∫–æ–≤—ñ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó** - —Ñ—ñ–Ω–∞–ª—å–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è
9. **–†–æ–∑—à–∏—Ä–µ–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó** - –Ω–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

## üéØ –û—á—ñ–∫—É–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏

–ü—ñ—Å–ª—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –≤—Å—ñ—Ö –ø–æ–∫—Ä–∞—â–µ–Ω—å –æ—á—ñ–∫—É—î–º–æ:
- ‚úÖ **–ó–º–µ–Ω—à–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –ø–æ–º–∏–ª–æ–∫** –Ω–∞ 60-80%
- ‚úÖ **–ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ** –Ω–∞ 30-50%
- ‚úÖ **–ó–º–µ–Ω—à–µ–Ω–Ω—è —á–∞—Å—É —Ä–æ–∑—Ä–æ–±–∫–∏** –Ω–∞ 40-60%
- ‚úÖ **–ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –∫–æ–¥—É** –Ω–∞ 70-90%
- ‚úÖ **–ó–±—ñ–ª—å—à–µ–Ω–Ω—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ** –Ω–∞ 80-95%

## üîß –¢–µ—Ö–Ω—ñ—á–Ω—ñ –≤–∏–º–æ–≥–∏

- **–°—É–º—ñ—Å–Ω—ñ—Å—Ç—å:** –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –≤—Å—ñ—Ö —Å—É—á–∞—Å–Ω–∏—Ö –±—Ä–∞—É–∑–µ—Ä—ñ–≤
- **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å:** –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è < 2 —Å–µ–∫—É–Ω–¥
- **–†–æ–∑–º—ñ—Ä:** –ó–∞–≥–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä JS < 500KB
- **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è:** –ü–æ–∫—Ä–∏—Ç—Ç—è —Ç–µ—Å—Ç–∞–º–∏ > 80%
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è:** 100% API –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω–æ
```

## üöÄ –§–∞–∑–∞ 2: –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥—ñ–π (Event System) - –í–ò–°–û–ö–ò–ô –ü–†–Ü–û–†–ò–¢–ï–¢ (2-3 —Ç–∏–∂–Ω—ñ)

### üéØ –ú–µ—Ç–∞
–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω—É —Å–∏—Å—Ç–µ–º—É –ø–æ–¥—ñ–π –¥–ª—è –∑–≤'—è–∑–∫—É –º—ñ–∂ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏, —â–æ –¥–æ–∑–≤–æ–ª–∏—Ç—å —Ä–æ–∑–≤'—è–∑–∞—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —Ç–∞ –ø–æ–∫—Ä–∞—â–∏—Ç–∏ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É.

### ‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏
- –†–æ–∑–≤'—è–∑—É–≤–∞–Ω–Ω—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
- –õ–µ–≥—à–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- –ö—Ä–∞—â–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–æ—Ç–æ–∫—É –¥–∞–Ω–∏—Ö
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å middleware
- –î–µ–±–∞–≥ —Ç–∞ –ª–æ–≥—É–≤–∞–Ω–Ω—è –ø–æ–¥—ñ–π

### 2.1 Event Bus

**–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª:** `js/event-bus.js`

```javascript
/**
 * –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–¥—ñ–π
 */
class EventBus {
    constructor() {
        this.listeners = new Map();
        this.middleware = [];
        this.isDestroyed = false;
    }
    
    /**
     * –ï–º—ñ—Ç—É—î –ø–æ–¥—ñ—é
     * @param {string} event - –ù–∞–∑–≤–∞ –ø–æ–¥—ñ—ó
     * @param {*} data - –î–∞–Ω—ñ –ø–æ–¥—ñ—ó
     */
    emit(event, data = {}) {
        if (this.isDestroyed) return;
        
        const eventData = {
            type: event,
            data,
            timestamp: Date.now(),
            id: this.generateEventId()
        };
        
        // –ó–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ middleware
        const processedData = this.applyMiddleware(eventData);
        if (processedData === null) return; // –ü–æ–¥—ñ—é –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ
        
        // –°–ø–æ–≤—ñ—â–∞—î–º–æ —Å–ª—É—Ö–∞—á—ñ–≤
        const listeners = this.listeners.get(event) || [];
        listeners.forEach(listener => {
            try {
                listener(processedData);
            } catch (error) {
                console.error(`Error in event listener for ${event}:`, error);
            }
        });
        
        // –õ–æ–≥—É—î–º–æ –ø–æ–¥—ñ—é –≤ —Ä–µ–∂–∏–º—ñ —Ä–æ–∑—Ä–æ–±–∫–∏
        if (process.env.NODE_ENV === 'development') {
            console.log(`Event emitted: ${event}`, processedData);
        }
    }
    
    /**
     * –î–æ–¥–∞—î —Å–ª—É—Ö–∞—á–∞ –ø–æ–¥—ñ—ó
     * @param {string} event - –ù–∞–∑–≤–∞ –ø–æ–¥—ñ—ó
     * @param {Function} handler - –û–±—Ä–æ–±–Ω–∏–∫ –ø–æ–¥—ñ—ó
     * @returns {Function} –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤—ñ–¥–ø–∏—Å–∫–∏
     */
    on(event, handler) {
        if (this.isDestroyed) return () => {};
        
        if (!this.listeners.has(event)) {
            this.listeners.set(event, []);
        }
        
        this.listeners.get(event).push(handler);
        
        // –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –≤—ñ–¥–ø–∏—Å–∫–∏
        return () => this.off(event, handler);
    }
    
    /**
     * –í–∏–¥–∞–ª—è—î —Å–ª—É—Ö–∞—á–∞ –ø–æ–¥—ñ—ó
     * @param {string} event - –ù–∞–∑–≤–∞ –ø–æ–¥—ñ—ó
     * @param {Function} handler - –û–±—Ä–æ–±–Ω–∏–∫ –ø–æ–¥—ñ—ó
     */
    off(event, handler) {
        if (this.isDestroyed) return;
        
        const listeners = this.listeners.get(event);
        if (listeners) {
            const index = listeners.indexOf(handler);
            if (index > -1) {
                listeners.splice(index, 1);
            }
            
            if (listeners.length === 0) {
                this.listeners.delete(event);
            }
        }
    }
    
    /**
     * –î–æ–¥–∞—î —Å–ª—É—Ö–∞—á–∞, —è–∫–∏–π —Å–ø—Ä–∞—Ü—å–æ–≤—É—î –æ–¥–∏–Ω —Ä–∞–∑
     * @param {string} event - –ù–∞–∑–≤–∞ –ø–æ–¥—ñ—ó
     * @param {Function} handler - –û–±—Ä–æ–±–Ω–∏–∫ –ø–æ–¥—ñ—ó
     */
    once(event, handler) {
        const onceHandler = (data) => {
            handler(data);
            this.off(event, onceHandler);
        };
        
        this.on(event, onceHandler);
    }
    
    /**
     * –î–æ–¥–∞—î middleware
     * @param {Function} middleware - Middleware —Ñ—É–Ω–∫—Ü—ñ—è
     */
    use(middleware) {
        this.middleware.push(middleware);
    }
    
    /**
     * –ó–∞—Å—Ç–æ—Å–æ–≤—É—î middleware –¥–æ –ø–æ–¥—ñ—ó
     * @param {Object} eventData - –î–∞–Ω—ñ –ø–æ–¥—ñ—ó
     * @returns {Object|null} –û–±—Ä–æ–±–ª–µ–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ null —è–∫—â–æ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ
     */
    applyMiddleware(eventData) {
        let processedData = eventData;
        
        for (const middleware of this.middleware) {
            try {
                processedData = middleware(processedData);
                if (processedData === null) return null; // –ü–æ–¥—ñ—é –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ
            } catch (error) {
                console.error('Middleware error:', error);
                return null;
            }
        }
        
        return processedData;
    }
    
    /**
     * –ì–µ–Ω–µ—Ä—É—î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π ID –¥–ª—è –ø–æ–¥—ñ—ó
     * @returns {string} –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π ID
     */
    generateEventId() {
        return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
    }
    
    /**
     * –û—á–∏—â—É—î –≤—Å—ñ —Å–ª—É—Ö–∞—á—ñ
     */
    clear() {
        this.listeners.clear();
    }
    
    /**
     * –ó–Ω–∏—â—É—î Event Bus
     */
    destroy() {
        this.clear();
        this.middleware = [];
        this.isDestroyed = true;
    }
    
    /**
     * –û—Ç—Ä–∏–º—É—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–¥—ñ–π
     * @returns {Object} –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
     */
    getStats() {
        const stats = {
            totalEvents: 0,
            activeListeners: 0,
            events: {}
        };
        
        for (const [event, listeners] of this.listeners) {
            stats.events[event] = listeners.length;
            stats.activeListeners += listeners.length;
        }
        
        return stats;
    }
}

// –°—Ç–≤–æ—Ä—é—î–º–æ –≥–ª–æ–±–∞–ª—å–Ω–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä
const eventBus = new EventBus();

// –ï–∫—Å–ø–æ—Ä—Ç
export { EventBus, eventBus };
```

### 2.2 –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ State Manager

**–û–Ω–æ–≤–∏—Ç–∏ —Ñ–∞–π–ª:** `js/state-manager.js`

```javascript
import { eventBus } from './event-bus.js';

class StateManager {
    constructor() {
        // ... —ñ—Å–Ω—É—é—á–∏–π –∫–æ–¥ ...
        
        // –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ Event Bus
        this.setupEventIntegration();
    }
    
    setupEventIntegration() {
        // –ï–º—ñ—Ç—É—î–º–æ –ø–æ–¥—ñ—ó –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Å—Ç–∞–Ω—É
        this.originalSetState = this.setState;
        this.setState = (path, value) => {
            const oldValue = this.getState(path);
            const success = this.originalSetState(path, value);
            
            if (success) {
                eventBus.emit('state.changed', {
                    path,
                    oldValue,
                    newValue: value,
                    timestamp: Date.now()
                });
                
                eventBus.emit(`state.changed.${path}`, {
                    oldValue,
                    newValue: value,
                    timestamp: Date.now()
                });
            }
            
            return success;
        };
    }
    
    // ... —ñ—Å–Ω—É—é—á–∏–π –∫–æ–¥ ...
}
```

### 2.3 Middleware –¥–ª—è –ª–æ–≥—É–≤–∞–Ω–Ω—è

**–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª:** `js/middleware/logger.js`

```javascript
/**
 * Middleware –¥–ª—è –ª–æ–≥—É–≤–∞–Ω–Ω—è –ø–æ–¥—ñ–π
 */
export function createLoggerMiddleware(options = {}) {
    const {
        enabled = process.env.NODE_ENV === 'development',
        level = 'info',
        filter = () => true
    } = options;
    
    return (eventData) => {
        if (!enabled) return eventData;
        if (!filter(eventData)) return eventData;
        
        const logLevel = eventData.level || level;
        const message = `[${eventData.type}] ${JSON.stringify(eventData.data)}`;
        
        switch (logLevel) {
            case 'error':
                console.error(message);
                break;
            case 'warn':
                console.warn(message);
                break;
            case 'debug':
                console.debug(message);
                break;
            default:
                console.log(message);
        }
        
        return eventData;
    };
}

/**
 * Middleware –¥–ª—è –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏
 */
export function createAnalyticsMiddleware(tracker) {
    return (eventData) => {
        // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –ø–æ–¥—ñ—é –≤ –∞–Ω–∞–ª—ñ—Ç–∏–∫—É
        if (tracker && typeof tracker.track === 'function') {
            tracker.track(eventData.type, eventData.data);
        }
        
        return eventData;
    };
}
```

## üöÄ –§–∞–∑–∞ 3: –°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è (2-3 –º—ñ—Å—è—Ü—ñ)

### 3.1 Unit —Ç–µ—Å—Ç–∏

**–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª:** `tests/state-manager.test.js`

```javascript
/**
 * Unit —Ç–µ—Å—Ç–∏ –¥–ª—è State Manager
 */
describe('StateManager', () => {
    let stateManager;
    
    beforeEach(() => {
        stateManager = new StateManager();
    });
    
    afterEach(() => {
        stateManager.destroy();
    });
    
    describe('getState', () => {
        test('should return entire state when no path provided', () => {
            const state = stateManager.getState();
            expect(state).toHaveProperty('settings');
            expect(state).toHaveProperty('game');
            expect(state).toHaveProperty('ui');
        });
        
        test('should return specific property when path provided', () => {
            const points = stateManager.getState('game.points');
            expect(points).toBe(0);
        });
        
        test('should return undefined for invalid path', () => {
            const value = stateManager.getState('invalid.path');
            expect(value).toBeUndefined();
        });
    });
    
    describe('setState', () => {
        test('should update state correctly', () => {
            stateManager.setState('game.points', 10);
            expect(stateManager.getState('game.points')).toBe(10);
        });
        
        test('should notify subscribers', () => {
            const mockCallback = jest.fn();
            stateManager.subscribe('game.points', mockCallback);
            
            stateManager.setState('game.points', 15);
            
            expect(mockCallback).toHaveBeenCalledWith(15, 0);
        });
        
        test('should validate values', () => {
            const result = stateManager.setState('game.currentPlayer', 3);
            expect(result).toBe(false);
            expect(stateManager.getState('game.currentPlayer')).toBe(1);
        });
    });
    
    describe('subscribe', () => {
        test('should add subscriber', () => {
            const mockCallback = jest.fn();
            const unsubscribe = stateManager.subscribe('game.points', mockCallback);
            
            expect(typeof unsubscribe).toBe('function');
        });
        
        test('should remove subscriber when unsubscribe called', () => {
            const mockCallback = jest.fn();
            const unsubscribe = stateManager.subscribe('game.points', mockCallback);
            
            unsubscribe();
            stateManager.setState('game.points', 20);
            
            expect(mockCallback).not.toHaveBeenCalled();
        });
    });
    
    describe('undo/redo', () => {
        test('should support undo operation', () => {
            stateManager.setState('game.points', 10);
            stateManager.setState('game.points', 20);
            
            stateManager.undo();
            expect(stateManager.getState('game.points')).toBe(10);
        });
        
        test('should support redo operation', () => {
            stateManager.setState('game.points', 10);
            stateManager.setState('game.points', 20);
            stateManager.undo();
            
            stateManager.redo();
            expect(stateManager.getState('game.points')).toBe(20);
        });
    });
});
```

### 3.2 Integration —Ç–µ—Å—Ç–∏

**–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª:** `tests/integration.test.js`

```javascript
/**
 * Integration —Ç–µ—Å—Ç–∏
 */
describe('Integration Tests', () => {
    let app;
    
    beforeEach(() => {
        // –°—Ç–≤–æ—Ä—é—î–º–æ —Ç–µ—Å—Ç–æ–≤–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ
        document.body.innerHTML = `
            <div id="main-menu" class="view active"></div>
            <div id="game" class="view"></div>
            <div id="settings" class="view"></div>
        `;
        
        app = new App();
    });
    
    afterEach(() => {
        app.destroy();
        document.body.innerHTML = '';
    });
    
    test('should navigate between views', () => {
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω
        expect(document.getElementById('main-menu').classList.contains('active')).toBe(true);
        
        // –ü–µ—Ä–µ—Ö–æ–¥–∏–º–æ –¥–æ –≥—Ä–∏
        stateManager.navigateTo('game');
        expect(document.getElementById('game').classList.contains('active')).toBe(true);
        expect(document.getElementById('main-menu').classList.contains('active')).toBe(false);
        
        // –ü–µ—Ä–µ—Ö–æ–¥–∏–º–æ –¥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
        stateManager.navigateTo('settings');
        expect(document.getElementById('settings').classList.contains('active')).toBe(true);
        expect(document.getElementById('game').classList.contains('active')).toBe(false);
    });
    
    test('should update UI when state changes', () => {
        // –ó–º—ñ–Ω—é—î–º–æ —Ç–µ–º—É
        stateManager.setState('settings.theme', 'dark');
        expect(document.documentElement.getAttribute('data-theme')).toBe('dark');
        
        // –ó–º—ñ–Ω—é—î–º–æ –º–æ–≤—É
        stateManager.setState('settings.language', 'en');
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —â–æ UI –æ–Ω–æ–≤–∏–≤—Å—è
    });
    
    test('should handle game flow', () => {
        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ –≥—Ä—É
        stateManager.initGame({
            boardSize: 5,
            gameMode: 'vsComputer'
        });
        
        expect(stateManager.getState('game.isActive')).toBe(true);
        expect(stateManager.getState('game.boardSize')).toBe(5);
        
        // –†–æ–±–∏–º–æ —Ö—ñ–¥
        stateManager.setState('game.selectedDirection', 'up');
        stateManager.setState('game.selectedDistance', 2);
        
        // –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î–º–æ —Ö—ñ–¥
        gameLogic.confirmMove();
        
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —â–æ —Ö—ñ–¥ –≤–∏–∫–æ–Ω–∞–Ω–æ
        expect(stateManager.getState('game.lastMove')).toBeTruthy();
    });
});
```

### 3.3 E2E —Ç–µ—Å—Ç–∏

**–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª:** `tests/e2e.test.js`

```javascript
/**
 * E2E —Ç–µ—Å—Ç–∏ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Playwright
 */
import { test, expect } from '@playwright/test';

test.describe('Stay on the Board E2E', () => {
    test.beforeEach(async ({ page }) => {
        await page.goto('http://localhost:3000');
    });
    
    test('should load main menu', async ({ page }) => {
        await expect(page.locator('#main-menu')).toBeVisible();
        await expect(page.locator('.game-title')).toHaveText('Stay on the board');
    });
    
    test('should navigate to settings', async ({ page }) => {
        await page.click('#settings-btn');
        await expect(page.locator('#settings')).toBeVisible();
        await expect(page.locator('#main-menu')).not.toBeVisible();
    });
    
    test('should change theme', async ({ page }) => {
        await page.click('#settings-btn');
        await page.selectOption('#theme-select', 'dark');
        
        await expect(page.locator('html')).toHaveAttribute('data-theme', 'dark');
    });
    
    test('should start game', async ({ page }) => {
        await page.click('#start-game-btn');
        await expect(page.locator('#game')).toBeVisible();
        await expect(page.locator('#game-board')).toBeVisible();
    });
    
    test('should play complete game', async ({ page }) => {
        // –ü–æ—á–∏–Ω–∞—î–º–æ –≥—Ä—É
        await page.click('#start-game-btn');
        
        // –í–∏–±—ñ—Ä –Ω–∞–ø—Ä—è–º–∫—É
        await page.click('#direction-grid button[data-direction="up"]');
        
        // –í–∏–±—ñ—Ä –≤—ñ–¥—Å—Ç–∞–Ω—ñ
        await page.click('#distance-selector button[data-distance="2"]');
        
        // –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —Ö–æ–¥—É
        await page.click('#confirm-move-btn');
        
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —â–æ —Ö—ñ–¥ –≤–∏–∫–æ–Ω–∞–Ω–æ
        await expect(page.locator('.cell.piece')).toBeVisible();
    });
    
    test('should handle online game', async ({ page, context }) => {
        // –°—Ç–≤–æ—Ä—é—î–º–æ –¥—Ä—É–≥—É –≤–∫–ª–∞–¥–∫—É –¥–ª—è —Å–∏–º—É–ª—è—Ü—ñ—ó –¥—Ä—É–≥–æ–≥–æ –≥—Ä–∞–≤—Ü—è
        const page2 = await context.newPage();
        await page2.goto('http://localhost:3000');
        
        // –°—Ç–≤–æ—Ä—é—î–º–æ –∫—ñ–º–Ω–∞—Ç—É –Ω–∞ –ø–µ—Ä—à—ñ–π –≤–∫–ª–∞–¥—Ü—ñ
        await page.click('#start-game-btn');
        await page.click('#online-game-btn');
        await page.click('#create-room-btn');
        
        const roomId = await page.locator('#room-id').textContent();
        
        // –ü—Ä–∏—î–¥–Ω—É—î–º–æ—Å—è –¥–æ –∫—ñ–º–Ω–∞—Ç–∏ –Ω–∞ –¥—Ä—É–≥—ñ–π –≤–∫–ª–∞–¥—Ü—ñ
        await page2.click('#start-game-btn');
        await page2.click('#online-game-btn');
        await page2.fill('#room-id-input', roomId);
        await page2.click('#join-room-btn');
        
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —â–æ –≥—Ä–∞ –ø–æ—á–∞–ª–∞—Å—è
        await expect(page.locator('#game')).toBeVisible();
        await expect(page2.locator('#game')).toBeVisible();
    });
});
```

## üöÄ –§–∞–∑–∞ 4: –ö–µ—à—É–≤–∞–Ω–Ω—è —Ç–∞ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è (1-2 –º—ñ—Å—è—Ü—ñ)

### 4.1 DOM –∫–µ—à

**–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª:** `js/utils/dom-cache.js`

```javascript
/**
 * –ö–µ—à –¥–ª—è DOM-–µ–ª–µ–º–µ–Ω—Ç—ñ–≤
 */
class DOMCache {
    constructor() {
        this.cache = new Map();
        this.observers = new Map();
        this.maxSize = 100;
    }
    
    /**
     * –û—Ç—Ä–∏–º—É—î –µ–ª–µ–º–µ–Ω—Ç –∑ –∫–µ—à—É –∞–±–æ DOM
     * @param {string} selector - CSS —Å–µ–ª–µ–∫—Ç–æ—Ä
     * @param {Element} [context] - –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—à—É–∫—É
     * @returns {Element|null} DOM –µ–ª–µ–º–µ–Ω—Ç
     */
    get(selector, context = document) {
        const key = this.getCacheKey(selector, context);
        
        if (this.cache.has(key)) {
            const cached = this.cache.get(key);
            if (this.isElementValid(cached.element)) {
                return cached.element;
            } else {
                this.cache.delete(key);
            }
        }
        
        const element = context.querySelector(selector);
        if (element) {
            this.set(key, element);
        }
        
        return element;
    }
    
    /**
     * –û—Ç—Ä–∏–º—É—î –≤—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –∑ –∫–µ—à—É –∞–±–æ DOM
     * @param {string} selector - CSS —Å–µ–ª–µ–∫—Ç–æ—Ä
     * @param {Element} [context] - –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—à—É–∫—É
     * @returns {NodeList} –°–ø–∏—Å–æ–∫ DOM –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
     */
    getAll(selector, context = document) {
        const key = this.getCacheKey(selector, context);
        
        if (this.cache.has(key)) {
            const cached = this.cache.get(key);
            if (this.isElementListValid(cached.elements)) {
                return cached.elements;
            } else {
                this.cache.delete(key);
            }
        }
        
        const elements = context.querySelectorAll(selector);
        if (elements.length > 0) {
            this.set(key, elements);
        }
        
        return elements;
    }
    
    /**
     * –í—Å—Ç–∞–Ω–æ–≤–ª—é—î –µ–ª–µ–º–µ–Ω—Ç –≤ –∫–µ—à
     * @param {string} key - –ö–ª—é—á –∫–µ—à—É
     * @param {Element|NodeList} element - DOM –µ–ª–µ–º–µ–Ω—Ç –∞–±–æ —Å–ø–∏—Å–æ–∫
     */
    set(key, element) {
        // –û–±–º–µ–∂—É—î–º–æ —Ä–æ–∑–º—ñ—Ä –∫–µ—à—É
        if (this.cache.size >= this.maxSize) {
            const firstKey = this.cache.keys().next().value;
            this.cache.delete(firstKey);
        }
        
        this.cache.set(key, {
            element: element,
            timestamp: Date.now()
        });
        
        // –î–æ–¥–∞—î–º–æ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—á –∑–∞ –∑–º—ñ–Ω–∞–º–∏
        this.observeElement(element);
    }
    
    /**
     * –û—á–∏—â—É—î –∫–µ—à
     */
    clear() {
        this.cache.clear();
        this.observers.forEach(observer => observer.disconnect());
        this.observers.clear();
    }
    
    /**
     * –ì–µ–Ω–µ—Ä—É—î –∫–ª—é—á –∫–µ—à—É
     * @param {string} selector - CSS —Å–µ–ª–µ–∫—Ç–æ—Ä
     * @param {Element} context - –ö–æ–Ω—Ç–µ–∫—Å—Ç
     * @returns {string} –ö–ª—é—á –∫–µ—à—É
     */
    getCacheKey(selector, context) {
        return `${context === document ? 'doc' : context.id || 'ctx'}:${selector}`;
    }
    
    /**
     * –ü–µ—Ä–µ–≤—ñ—Ä—è—î —á–∏ –µ–ª–µ–º–µ–Ω—Ç –≤—Å–µ —â–µ –≤–∞–ª—ñ–¥–Ω–∏–π
     * @param {Element} element - DOM –µ–ª–µ–º–µ–Ω—Ç
     * @returns {boolean} –ß–∏ –≤–∞–ª—ñ–¥–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç
     */
    isElementValid(element) {
        return element && element.parentNode && document.contains(element);
    }
    
    /**
     * –ü–µ—Ä–µ–≤—ñ—Ä—è—î —á–∏ —Å–ø–∏—Å–æ–∫ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –≤–∞–ª—ñ–¥–Ω–∏–π
     * @param {NodeList} elements - –°–ø–∏—Å–æ–∫ DOM –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
     * @returns {boolean} –ß–∏ –≤–∞–ª—ñ–¥–Ω–∏–π —Å–ø–∏—Å–æ–∫
     */
    isElementListValid(elements) {
        if (!elements || elements.length === 0) return false;
        
        for (let i = 0; i < elements.length; i++) {
            if (!this.isElementValid(elements[i])) {
                return false;
            }
        }
        
        return true;
    }
    
    /**
     * –î–æ–¥–∞—î —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—á –∑–∞ –µ–ª–µ–º–µ–Ω—Ç–æ–º
     * @param {Element|NodeList} element - DOM –µ–ª–µ–º–µ–Ω—Ç –∞–±–æ —Å–ø–∏—Å–æ–∫
     */
    observeElement(element) {
        if (element instanceof NodeList) {
            for (let i = 0; i < element.length; i++) {
                this.observeElement(element[i]);
            }
            return;
        }
        
        if (this.observers.has(element)) return;
        
        const observer = new MutationObserver(() => {
            // –ï–ª–µ–º–µ–Ω—Ç –∑–º—ñ–Ω–∏–≤—Å—è, –≤–∏–¥–∞–ª—è—î–º–æ –∑ –∫–µ—à—É
            this.removeFromCache(element);
        });
        
        observer.observe(element, {
            childList: true,
            subtree: true,
            attributes: true
        });
        
        this.observers.set(element, observer);
    }
    
    /**
     * –í–∏–¥–∞–ª—è—î –µ–ª–µ–º–µ–Ω—Ç –∑ –∫–µ—à—É
     * @param {Element} element - DOM –µ–ª–µ–º–µ–Ω—Ç
     */
    removeFromCache(element) {
        for (const [key, cached] of this.cache) {
            if (cached.element === element) {
                this.cache.delete(key);
                break;
            }
        }
        
        const observer = this.observers.get(element);
        if (observer) {
            observer.disconnect();
            this.observers.delete(element);
        }
    }
    
    /**
     * –û—Ç—Ä–∏–º—É—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–µ—à—É
     * @returns {Object} –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
     */
    getStats() {
        return {
            size: this.cache.size,
            maxSize: this.maxSize,
            hitRate: this.calculateHitRate(),
            memoryUsage: this.estimateMemoryUsage()
        };
    }
    
    /**
     * –†–æ–∑—Ä–∞—Ö–æ–≤—É—î —á–∞—Å—Ç–æ—Ç—É –ø–æ–ø–∞–¥–∞–Ω—å –≤ –∫–µ—à
     * @returns {number} –ß–∞—Å—Ç–æ—Ç–∞ –ø–æ–ø–∞–¥–∞–Ω—å (0-1)
     */
    calculateHitRate() {
        // –ü—Ä–æ—Å—Ç–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è - –º–æ–∂–Ω–∞ –ø–æ–∫—Ä–∞—â–∏—Ç–∏
        return this.cache.size / this.maxSize;
    }
    
    /**
     * –û—Ü—ñ–Ω—é—î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ
     * @returns {number} –†–æ–∑–º—ñ—Ä –≤ –±–∞–π—Ç–∞—Ö
     */
    estimateMemoryUsage() {
        let size = 0;
        for (const [key, value] of this.cache) {
            size += key.length * 2; // UTF-16
            size += 8; // timestamp
            size += 8; // element reference
        }
        return size;
    }
}

// –ì–ª–æ–±–∞–ª—å–Ω–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä
const domCache = new DOMCache();

export { DOMCache, domCache };
```

### 4.2 –ú–µ–º–æ—ñ–∑–∞—Ü—ñ—è

**–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª:** `js/utils/memoize.js`

```javascript
/**
 * –£—Ç–∏–ª—ñ—Ç–∏ –¥–ª—è –º–µ–º–æ—ñ–∑–∞—Ü—ñ—ó
 */

/**
 * –ú–µ–º–æ—ñ–∑—É—î —Ñ—É–Ω–∫—Ü—ñ—é
 * @param {Function} fn - –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –º–µ–º–æ—ñ–∑–∞—Ü—ñ—ó
 * @param {Object} options - –û–ø—Ü—ñ—ó
 * @returns {Function} –ú–µ–º–æ—ñ–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è
 */
export function memoize(fn, options = {}) {
    const {
        maxSize = 100,
        ttl = null, // Time to live –≤ –º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥–∞—Ö
        keyGenerator = JSON.stringify
    } = options;
    
    const cache = new Map();
    
    return function(...args) {
        const key = keyGenerator(args);
        
        if (cache.has(key)) {
            const cached = cache.get(key);
            
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ TTL
            if (ttl && Date.now() - cached.timestamp > ttl) {
                cache.delete(key);
            } else {
                return cached.value;
            }
        }
        
        const result = fn.apply(this, args);
        
        // –û–±–º–µ–∂—É—î–º–æ —Ä–æ–∑–º—ñ—Ä –∫–µ—à—É
        if (cache.size >= maxSize) {
            const firstKey = cache.keys().next().value;
            cache.delete(firstKey);
        }
        
        cache.set(key, {
            value: result,
            timestamp: Date.now()
        });
        
        return result;
    };
}

/**
 * –ú–µ–º–æ—ñ–∑—É—î –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é
 * @param {Function} fn - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è
 * @param {Object} options - –û–ø—Ü—ñ—ó
 * @returns {Function} –ú–µ–º–æ—ñ–∑–æ–≤–∞–Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è
 */
export function memoizeAsync(fn, options = {}) {
    const {
        maxSize = 100,
        ttl = null,
        keyGenerator = JSON.stringify
    } = options;
    
    const cache = new Map();
    const pending = new Map();
    
    return async function(...args) {
        const key = keyGenerator(args);
        
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –∫–µ—à
        if (cache.has(key)) {
            const cached = cache.get(key);
            
            if (ttl && Date.now() - cached.timestamp > ttl) {
                cache.delete(key);
            } else {
                return cached.value;
            }
        }
        
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –≤–∂–µ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è
        if (pending.has(key)) {
            return pending.get(key);
        }
        
        // –í–∏–∫–æ–Ω—É—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é
        const promise = fn.apply(this, args);
        pending.set(key, promise);
        
        try {
            const result = await promise;
            
            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            if (cache.size >= maxSize) {
                const firstKey = cache.keys().next().value;
                cache.delete(firstKey);
            }
            
            cache.set(key, {
                value: result,
                timestamp: Date.now()
            });
            
            pending.delete(key);
            return result;
        } catch (error) {
            pending.delete(key);
            throw error;
        }
    };
}

/**
 * –ú–µ–º–æ—ñ–∑—É—î –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –∑ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—è–º–∏
 * @param {Function} computeFn - –§—É–Ω–∫—Ü—ñ—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è
 * @param {Function} depsFn - –§—É–Ω–∫—Ü—ñ—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
 * @returns {Function} –ú–µ–º–æ—ñ–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è
 */
export function memoizeWithDeps(computeFn, depsFn) {
    let lastDeps = null;
    let lastResult = null;
    
    return function(...args) {
        const deps = depsFn(...args);
        
        if (lastDeps && JSON.stringify(deps) === JSON.stringify(lastDeps)) {
            return lastResult;
        }
        
        lastDeps = deps;
        lastResult = computeFn(...args);
        
        return lastResult;
    };
}

/**
 * LRU –∫–µ—à
 */
export class LRUCache {
    constructor(maxSize = 100) {
        this.maxSize = maxSize;
        this.cache = new Map();
    }
    
    get(key) {
        if (this.cache.has(key)) {
            const value = this.cache.get(key);
            this.cache.delete(key);
            this.cache.set(key, value);
            return value;
        }
        return undefined;
    }
    
    set(key, value) {
        if (this.cache.has(key)) {
            this.cache.delete(key);
        } else if (this.cache.size >= this.maxSize) {
            const firstKey = this.cache.keys().next().value;
            this.cache.delete(firstKey);
        }
        
        this.cache.set(key, value);
    }
    
    clear() {
        this.cache.clear();
    }
    
    get size() {
        return this.cache.size;
    }
}
```

## üìä –ü–ª–∞–Ω —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

### –¢–∏–∂–¥–µ–Ω—å 1-2: –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞
- [ ] –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ —Ä–æ–∑—Ä–æ–±–∫–∏
- [ ] –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ —Ç–µ—Å—Ç—ñ–≤
- [ ] –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è CI/CD

### –¢–∏–∂–¥–µ–Ω—å 3-4: JSDoc –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- [ ] –î–æ–∫—É–º–µ–Ω—Ç—É–≤–∞–Ω–Ω—è State Manager
- [ ] –î–æ–∫—É–º–µ–Ω—Ç—É–≤–∞–Ω–Ω—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
- [ ] –î–æ–∫—É–º–µ–Ω—Ç—É–≤–∞–Ω–Ω—è —É—Ç–∏–ª—ñ—Ç

### –¢–∏–∂–¥–µ–Ω—å 5-6: TypeScript definitions
- [ ] –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∏–ø—ñ–≤ –¥–ª—è State Manager
- [ ] –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∏–ø—ñ–≤ –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
- [ ] –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∏–ø—ñ–≤ –¥–ª—è –ø–æ–¥—ñ–π

### –¢–∏–∂–¥–µ–Ω—å 7-8: Event System
- [ ] –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è Event Bus
- [ ] –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ State Manager
- [ ] Middleware –¥–ª—è –ª–æ–≥—É–≤–∞–Ω–Ω—è

### –¢–∏–∂–¥–µ–Ω—å 9-10: Unit —Ç–µ—Å—Ç–∏
- [ ] –¢–µ—Å—Ç–∏ –¥–ª—è State Manager
- [ ] –¢–µ—Å—Ç–∏ –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
- [ ] –¢–µ—Å—Ç–∏ –¥–ª—è —É—Ç–∏–ª—ñ—Ç

### –¢–∏–∂–¥–µ–Ω—å 11-12: Integration —Ç–µ—Å—Ç–∏
- [ ] –¢–µ—Å—Ç–∏ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó
- [ ] –¢–µ—Å—Ç–∏ –∑–º—ñ–Ω–∏ —Å—Ç–∞–Ω—É
- [ ] –¢–µ—Å—Ç–∏ —ñ–≥—Ä–æ–≤–æ—ó –ª–æ–≥—ñ–∫–∏

### –¢–∏–∂–¥–µ–Ω—å 13-14: E2E —Ç–µ—Å—Ç–∏
- [ ] –¢–µ—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤
- [ ] –¢–µ—Å—Ç–∏ –æ–Ω–ª–∞–π–Ω –≥—Ä–∏
- [ ] –¢–µ—Å—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

### –¢–∏–∂–¥–µ–Ω—å 15-16: –ö–µ—à—É–≤–∞–Ω–Ω—è
- [ ] DOM –∫–µ—à
- [ ] –ú–µ–º–æ—ñ–∑–∞—Ü—ñ—è
- [ ] –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

## üéØ –û—á—ñ–∫—É–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏

–ü—ñ—Å–ª—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ü–∏—Ö –ø–æ–∫—Ä–∞—â–µ–Ω—å:

1. **–Ø–∫—ñ—Å—Ç—å –∫–æ–¥—É** –ø–æ–∫—Ä–∞—â–∏—Ç—å—Å—è –∑–∞–≤–¥—è–∫–∏ —Ç–∏–ø—ñ–∑–∞—Ü—ñ—ó —Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó
2. **–°—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å** –∑—Ä–æ—Å—Ç–µ –∑–∞–≤–¥—è–∫–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—é
3. **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å** –ø–æ–∫—Ä–∞—â–∏—Ç—å—Å—è –∑–∞–≤–¥—è–∫–∏ –∫–µ—à—É–≤–∞–Ω–Ω—é
4. **–†–æ–∑—à–∏—Ä—é–≤–∞–Ω—ñ—Å—Ç—å** –∑—Ä–æ—Å—Ç–µ –∑–∞–≤–¥—è–∫–∏ —Å–∏—Å—Ç–µ–º—ñ –ø–æ–¥—ñ–π
5. **–ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ—Å—Ç—å** –ø–æ–∫—Ä–∞—â–∏—Ç—å—Å—è –∑–∞–≤–¥—è–∫–∏ –ª–æ–≥—É–≤–∞–Ω–Ω—é —Ç–∞ –¥–µ–±–∞–≥—É

–¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –ª–µ–≥–∫–æ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó, –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –∫–æ–¥ —Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ –¥–æ–≤–≥–æ—Å—Ç—Ä–æ–∫–æ–≤—É —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç—É. 