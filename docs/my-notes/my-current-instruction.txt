logService.js:112 Uncaught (in promise) RangeError: Maximum call stack size exceeded
    at Object.logicMove (logService.js:112:79)
    at CommandService.handleCloseModal (commandService.ts:30:16)
    at commandService.ts:16:53
    at gameEventBus.ts:43:58
    at Array.forEach (<anonymous>)
    at GameEventBus.dispatch (gameEventBus.ts:43:38)
    at SideEffectService.execute (sideEffectService.ts:32:22)
    at CommandService.handleCloseModal (commandService.ts:31:23)
    at commandService.ts:16:53
    at gameEventBus.ts:43:58
logicMove @ logService.js:112
handleCloseModal @ commandService.ts:30
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31
(anonymous) @ commandService.ts:16
(anonymous) @ gameEventBus.ts:43
dispatch @ gameEventBus.ts:43
execute @ sideEffectService.ts:32
handleCloseModal @ commandService.ts:31

---

Error: expect(locator).not.toBeVisible() failed

Locator:  getByTestId('opponent-trapped-modal')
Expected: not visible
Received: visible
Timeout:  5000ms

Call log:
  - Expect "not toBeVisible" with timeout 5000ms
  - waiting for getByTestId('opponent-trapped-modal')
    9 × locator resolved to <div class="modal-window s-CbKqU8tqPnSX" data-testid="opponent-trapped-modal">…</div>
      - unexpected value "visible"


  46 |
  47 |       await page.getByTestId('continue-game-no-moves-btn').click();
> 48 |       await expect(page.getByTestId('opponent-trapped-modal')).not.toBeVisible();
     |                                                                    ^
  49 |     });
  50 |
  51 |     await test.step('Гравець робить наступні ходи', async () => {
    at C:\Users\ozapolnov\Documents\code\study\Stay_on_the_board\tests\happy-flow-1.spec.ts:48:68
    at C:\Users\ozapolnov\Documents\code\study\Stay_on_the_board\tests\happy-flow-1.spec.ts:42:5

---

це сталося після @git-changes 
@/docs/plans/architecture-improvement-SoC-plan-v22.md 