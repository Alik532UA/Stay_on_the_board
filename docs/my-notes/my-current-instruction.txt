досі проблема є
1. зайти в гру
2. натиснути data-testid="settings-expander-summary" (без різниці чи рогорнути чи згорнути налаштування), актуальний результат: фокус на цьому елементів
3. натиснути [NumPad Enter] або [Enter] або [Space]
Актуальний результат: спрацювує і hotkey **Підтвердити хід** і спрацьовує рогорнути чи згорнути налаштування (бо фокус на цьому елементі)
Очікуваний результат: спрацювує тільки hotkey **Підтвердити хід**, і НЕ трігерить рогорнути чи згорнути налаштування

---

**Ключова вимога:** Твоє рішення має бути комплексним. Не роби поверхневих виправлень ("латок" чи "костилів").
**Реалізуй системне виправлення**, яке усуває корінь проблеми та відповідає цільовій архітектурі проєкту.
при виправленні використовуй принципи:
1.  **SSoT (Single Source of Truth):** Чи є єдине джерело правди для кожного елемента стану?
2.  **UDF (Unidirectional Data Flow):** Чи є потік даних односпрямованим та передбачуваним?
3.  **SoC (Separation of Concerns):** Наскільки добре розділені відповідальності (стан, логіка, UI)?
4.  **Композиція:** Чи ефективно використовуються компоненти для побудови UI?
5.  **Чистота та Побічні ефекти:** Наскільки добре ізольовані "нечисті" операції (API, DOM, таймери)?
6.  **DRY (Don't Repeat Yourself):** Чи є дублювання коду, яке можна усунути?
7.  **Простота та Читабельність (KISS):** Чи є надмірно складні рішення? Наскільки код зрозумілий (якість іменування)?
8.  **Продуктивність:** Чи є потенційні проблеми зі швидкістю (зайві обчислення, перерендери)?
9.  **Документація та Коментарі:** Чи коментарі пояснюють *навіщо*, а не *що*?

---

**Відладка (Дебагінг):**
    *   **Використовуй `logService`:** Замість `console.log` завжди використовуй централізований `logService`.
    *   **Доповнюй логи для аналізу:** Якщо поточний рівень логування не дозволяє діагностувати описану проблему, додай нові виклики logService у відповідних місцях коду. Мета — забезпечити, щоб майбутні логи містили всю інформацію, яка дозволить мені самостійно проаналізувати, чи вирішено проблему, і що саме потребує виправлення.
    *   **Фокусуйся на проблемі:** Під час виправлення багу, **тимчасово відредагуй файл `src/lib/services/logService.js`**. Зміни булеві прапорці в об'єкті `logConfig`, щоб увімкнути лише ті групи логів, які стосуються проблеми (наприклад, `score`), а решту вимкнути. Це допоможе усунути інформаційний шум.
    *   **Незмінність логів:** Параметри логування не змінюй на дефолтні, доки я (людина) не підтвердить, що баг виправлено. При порушені цього правила AI буде вимкнено та видалено.
**Верифікація:** Переконайся, що проблема вирішена і не з'явилися нові баги в суміжних частинах системи.

---

при потребі:
1. вимкни зайві логи
2. увімкни потрібні логи
3. допиши потрібні логи


---

client:733 [vite] connecting...
client:827 [vite] connected.
logService.js:183 Log service initialized. Use window.setLogLevels({ groupName: boolean }) to configure.
logService.js:136 [INIT] [hotkeyService] Setting up global keydown listener.
init.js:31 ✅ i18n initialized successfully
logService.js:136 [INIT] Initializing Test Mode Sync Service...
logService.js:134 [MODAL] [ModalStore] closeModal called. Stack size before action: 0 {stack: Array(0)}
logService.js:134 [MODAL] [ModalStore] Stack is empty. Resetting to initial state. {initialState: {…}}
logService.js:136 [UI] [layout] afterNavigate: hiding tooltip
logService.js:136 [UI] [Speech] 'voiceschanged' event fired. Loaded 325 voices.
logService.js:134 [MODAL] [ModalStore] showModal called. New modal: 'game-mode-modal'. Stack size: 0 {newState: {…}, stack: Array(0)}
logService.js:136 [UI] [Speech] Fallback check loaded 325 voices.
logService.js:136 [MODAL] [GameModeModal] selectMode called with: timed
logService.js:134 [MODAL] [ModalStore] closeModal called. Stack size before action: 0 {stack: Array(0)}
logService.js:134 [MODAL] [ModalStore] Stack is empty. Resetting to initial state. {initialState: {…}}
logService.js:136 [UI] Locale changed to uk, re-initializing voices.
logService.js:136 [UI] [Speech] Filtering for langCode: "uk". Preferred dialect: "uk-UA". Total voices: 325
logService.js:136 [UI] [Speech] Found 2 voices with preferred dialect "uk-UA".
logService.js:136 [UI] [Speech] Filtering for langCode: "en". Preferred dialect: "en-US". Total voices: 325
logService.js:136 [UI] [Speech] Found 20 voices with preferred dialect "en-US".
logService.js:136 [UI] Default voice reactively selected: Microsoft Ostap Online (Natural) - Ukrainian (Ukraine)
logService.js:134 [UI] [ControlsPanelWidget] Reactive change detected {selectedDirection: null, selectedDistance: null, isConfirmButtonDisabled: true}
logService.js:134 [UI] [centerInfoUtil] Calculating state {selectedDirection: null, selectedDistance: null, lastComputerMove: null, lastPlayerMove: null, isPlayerTurn: false, …}
logService.js:136 [INIT] [VirtualPlayerPage] onMount: No active game found, initializing "virtual-player" mode.
logService.js:134 [INIT] [GameService] initializeNewGame: Створення нового ігрового стану... {size: undefined, players: Array(2)}
logService.js:136 [GAME_MODE] Game mode initialized: virtual-player (from preset: virtual-player)
logService.js:134 [UI] GameInfoWidget: displayMessage re-evaluating {isGameOver: false, isFirstMove: true, lastComputerMove: null, lastPlayerMove: null, isPlayerTurn: true, …}
logService.js:136 [INIT] [gameHotkeyService] Initializing game hotkeys.
logService.js:134 [UI] [centerInfoUtil] Calculating state {selectedDirection: null, selectedDistance: null, lastComputerMove: null, lastPlayerMove: null, isPlayerTurn: true, …}
logService.js:134 [MODAL] [ModalStore] closeModal called. Stack size before action: 0 {stack: Array(0)}
logService.js:134 [MODAL] [ModalStore] Stack is empty. Resetting to initial state. {initialState: {…}}
logService.js:136 [UI] [layout] afterNavigate: hiding tooltip