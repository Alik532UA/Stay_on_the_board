---
type: feature-documentation
title: Повторне відтворення при поверненні до гри
status: done
---

### Опис функції

Цей документ описує візуальну функцію, за якої при поверненні до незавершеної гри інтерфейс анімує всі ходи від початку сесії до поточного стану. Це створює ефект "повторного відтворення" для користувача.

За замовчуванням ця функція **вимкнена** на користь миттєвого відображення поточного стану гри.

### Як це працює

Анімація обробляється компонентом `src/lib/components/widgets/BoardWrapperWidget.svelte`. Він підтримує локальний `lastProcessedMoveIndex`, який відстежує, скільки ходів з `gameState.moveQueue` було анімовано.

Коли компонент демонтується (наприклад, при переході до головного меню), а потім знову монтується, цей локальний індекс скидається до `0`. Логіка анімації в хуку `$effect` потім бачить всю `moveQueue` як "нову" і обробляє її з самого початку, викликаючи ефект повторного відтворення.

### Як знову ввімкнути цю функцію

Щоб відновити поведінку "повторного відтворення при поверненні", вам потрібно змінити `src/lib/components/widgets/BoardWrapperWidget.svelte`.

1.  Знайдіть функцію життєвого циклу `onMount` у блоці `<script>`.
2.  Закоментуйте або видаліть весь блок `onMount`.

**Код для коментування:**

```javascript
onMount(() => {
    // При монтуванні негайно синхронізувати візуальний стан з логічним
    const currentState = get(gameState);
    visualRow = currentState.playerRow;
    visualCol = currentState.playerCol;
    
    // І повідомити процесор анімації, що всі ходи в черзі "старі"
    lastProcessedMoveIndex = currentState.moveQueue.length;
});
```

Видаливши цей блок, `lastProcessedMoveIndex` залишиться `0` при монтуванні компонента, і логіка анімації повторно відтворить усі ходи з черги.