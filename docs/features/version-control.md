# Система контролю версій та оновлення

## 1. Проблема

Оскільки додаток є статичним сайтом (PWA), браузери агресивно кешують його файли. Це призводить до того, що після розгортання нової версії користувачі продовжують бачити стару, закешовану версію, що є критичною проблемою для UX.

## 2. Рішення

Впроваджено автоматичну систему перевірки версії, яка працює на стороні клієнта.

### 2.1. Механізм роботи

1.  **Файл версії:** У теці `/static` знаходиться файл `version.json`, який містить поточну версію додатку (напр., `{"version": "1.0.0"}`). Цей файл оновлюється розробником при кожному новому релізі.

2.  **Перевірка при завантаженні:** При кожному завантаженні додатку, головний компонент (`+layout.svelte`) асинхронно завантажує `version.json` з сервера, додаючи унікальний параметр до URL, щоб уникнути кешування.

3.  **Порівняння версій:**
    *   Версія з сервера порівнюється з версією, збереженою в `localStorage` користувача (`app_version`).
    *   Якщо версії не збігаються, це означає, що доступне оновлення.

4.  **Сповіщення користувача:**
    *   Якщо виявлено нову версію, внизу екрана з'являється ненав'язливе сповіщення з пропозицією оновитися.
    *   При натисканні на кнопку "Оновити", виконується **повне очищення `localStorage`** та **примусове перезавантаження сторінки з сервера** (`location.reload(true)`).

### 2.2. Процес оновлення для розробника

Після внесення значних змін та перед розгортанням нової версії, необхідно **вручну** оновити номер версії у файлі `svelte-app/static/version.json` (напр., з "1.0.0" на "1.0.1"). 