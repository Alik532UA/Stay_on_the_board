# План Покращення Архітектури v9

Цей документ містить комплексний аудит коду після рефакторингу та визначає наступні кроки для підготовки додатку до масштабування, зокрема до інтеграції онлайн-режиму.

## Частина 1: Аудит Коду (після рефакторингу)

### Архітектура та Структура

1.  **SSoT (Single Source of Truth):** 95/100
    *   **Позитивно:** Стан гри тепер повністю консолідований у `gameState`. `localGameStore` використовується лише для налаштувань, що є значним покращенням. Рахунок кожного гравця є частиною об'єкта `Player`, що робить `gameState` єдиним джерелом правди.

2.  **UDF (Unidirectional Data Flow):** 90/100
    *   **Позитивно:** Потік даних став ще більш чітким. UI-компоненти (`+page.svelte`) тепер майже повністю "дурні" і лише викликають методи оркестратора, не містячи складної логіки.

3.  **SoC (Separation of Concerns):** 90/100
    *   **Позитивно:** `gameOrchestrator` тепер є чистим координатором, що делегує всю специфічну логіку відповідним класам `GameMode`. Це кардинально покращило розділення відповідальностей.

4.  **Композиція:** 90/100
    *   **Позитивно:** Без змін, залишається сильною стороною.

5.  **Чистота та Побічні ефекти:** 85/100
    *   **Позитивно:** Побічні ефекти, пов'язані з модальними вікнами, тепер інкапсульовані в межах кожного `GameMode`, що робить їх більш передбачуваними.

### Якість Коду та Реалізації

6.  **DRY (Don't Repeat Yourself):** 95/100
    *   **Позитивно:** Логіка "немає ходів" тепер винесена в єдиний метод `handleNoMoves` у `VsComputerGameMode`, що усунуло дублювання.

7.  **Простота та Читабельність (KISS):** 90/100
    *   **Позитивно:** `gameOrchestrator` став значно меншим і простішим для розуміння. Логіка кожного режиму гри тепер ізольована, що полегшує її читання та підтримку.

8.  **Продуктивність:** 85/100
    *   **Позитивно:** Без змін.

9.  **Документація та Коментарі:** 95/100
    *   **Позитивно:** Без змін.

## Частина 2: План Покращень

### Пріоритезований Список Завдань

- [ ] **Створити `OnlineGameMode` та інтегрувати WebSocket.** (Пріоритет: 100)
    *   **Проблема:** Поточна архітектура не підтримує гру в реальному часі з іншими гравцями.
    *   **Рішення:** Створити новий клас `OnlineGameMode`, що реалізує інтерфейс `IGameMode`. Цей клас буде відповідати за взаємодію з WebSocket-сервером для надсилання та отримання ходів, синхронізації стану гри та обробки онлайн-подій.

- [ ] **Рефакторинг `gameOverStore` для підтримки кількох гравців.** (Пріоритет: 90)
    *   **Проблема:** `gameOverStore` все ще орієнтований на гру з двома гравцями (player1, player2).
    *   **Рішення:** Оновити структуру `gameOverStore`, щоб він міг зберігати результати для довільної кількості гравців, використовуючи масив результатів, аналогічно до того, як це зроблено в `gameState`.

- [ ] **Винести логіку навігації з `gameOrchestrator`.** (Пріоритет: 80)
    *   **Проблема:** `gameOrchestrator` все ще відповідає за навігацію (`goto('/replay')`).
    *   **Рішення:** Створити `NavigationService`, який буде обробляти всі переходи між сторінками. Оркестратор буде викликати методи цього сервісу, що ще більше покращить SoC.