# План фіналізації архітектурного рефакторингу

**Мета:** Завершити рефакторинг, видаливши застарілий код з `gameStore.js` та виправити пов'язані з цим помилки компіляції, щоб остаточно перейти на нову архітектуру з оркестратором.

---

## Фаза 1: Очищення `gameStore.js` від застарілої логіки

- [x] **Блок 1: Видалення великих функцій-процесів**
    - [x] Відкрити файл `svelte-app/src/lib/stores/gameStore.js`.
    - [x] Знайти та повністю видалити наступні функції:
        - `confirmMove`
        - `makeComputerMove`
        - `noMoves`
        - `advanceTurn`
        - `performMove` (стару, не `_performMoveInternal`)

- [x] **Блок 2: Видалення невикористовуваних імпортів**
    - [x] У файлі `svelte-app/src/lib/stores/gameStore.js`, переглянути верхню частину файлу.
    - [x] Знайти та видалити наступні рядки імпортів:
      ```javascript
      import { speakText, langMap } from '$lib/speech.js';
      ```
    - [x] Перевірити, чи не залишилось інших невикористовуваних імпортів, і видалити їх.

---

## Фаза 2: Виправлення помилок компіляції та логіки

- [x] **Блок 3: Виправлення логіки `_performMoveInternal`**
    - [x] У файлі `svelte-app/src/lib/stores/gameStore.js`, знайти функцію `_performMoveInternal`.
    - [x] Усередині цієї функції, знайти рядок, що оновлює `moveHistory`.
        *   Виправити його, щоб він зберігав `visits` замість `blocked`.

- [x] **Блок 4: Виправлення логіки `resetGame`**
    - [x] У файлі `gameStore.js`, знайти функцію `resetGame`.
    - [x] Усередині цієї функції, знайти рядок, що ініціалізує `moveHistory`.
        *   Виправити його, щоб він ініціалізував `visits`.

- [x] **Блок 5: Виправлення логіки `setBoardSize`**
    - [x] У файлі `gameStore.js`, знайти функцію `setBoardSize`.
    - [x] Усередині цієї функції, знайти рядок, що ініціалізує `moveHistory`.
        *   Виправити його, щоб він ініціалізував `visits`.

---

## Фаза 3: Фінальна верифікація

- [x] **Блок 6: Перевірка працездатності гри**
    - [x] Запустити проєкт у режимі розробки.
    - [x] Відкрити гру в браузері та переконатися, що немає помилок у консолі.
    - [x] **Провести повний ігровий цикл:**
        - [x] Зробити хід як гравець.
        - [x] Переконатися, що комп'ютер ходить у відповідь.
        - [x] Перевірити, що рахунок оновлюється.
        - [x] Увімкнути режим блокування і зробити кілька ходів, щоб переконатися, що клітинки блокуються.
        - [x] Натиснути кнопку "Ходів немає" і перевірити, що з'являється відповідне модальне вікно.
        - [x] Програти, вийшовши за межі дошки, і переконатися, що з'являється модальне вікно завершення гри.
        - [x] Натиснути "Грати ще раз" і переконатися, що гра коректно перезапускається.