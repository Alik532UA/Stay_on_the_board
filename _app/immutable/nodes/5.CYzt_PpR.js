import"../chunks/NZTpNUN0.js";import"../chunks/B-vN-kXS.js";import{o as Lt}from"../chunks/CREhLT6v.js";import{F as Ke,H as Zt,a$ as Wt,b0 as Jt,aW as Xt,B as Qt,U as Yt,T as eo,N as to,aa as oo,r as ao,aI as lo,an as so,q as Ct,as as lt,aJ as K,aK as At,f as $,c as i,s as u,h as e,t as I,a as C,at as st,m as Je,u as N,_ as U,j as O,n as Ge,d as n,aj as no,aM as et,b as ze,aL as ro,aN as St,a_ as io}from"../chunks/CYlQx1xG.js";import{l as co,w as nt,g as ue,b as vo,d as ut,a as E,e as Ce}from"../chunks/DcER0RSx.js";import{i as T}from"../chunks/D-N3Gt0C.js";import{e as Ue,i as tt}from"../chunks/oM2XVRE2.js";import{a as qe,s as ve,r as Ie,b as uo}from"../chunks/BEa8ETS_.js";import{t as po,s as de}from"../chunks/BKNfVhGR.js";import{i as pt}from"../chunks/CKHjg-0V.js";import{s as gt,a as $e}from"../chunks/CcT2DH85.js";import{$ as rt,a as go}from"../chunks/DdbUh-Fj.js";import{l as re,s as Ne}from"../chunks/BvbyETv1.js";import{g as fo}from"../chunks/CIIxyVjQ.js";import{b as bo}from"../chunks/C7R43KLt.js";import{p as mo}from"../chunks/m9Q1QfxC.js";function _o(o,l,a){Ke&&Zt();var s=o,t=oo,v,r=Wt()?Jt:Xt;Qt(()=>{r(t,t=l())&&(v&&Yt(v),v=eo(()=>a(s)))}),Ke&&(s=to)}function ho(o,l,a,s){var t=o.__style;if(Ke||t!==l){var v=po(l);(!Ke||v!==o.getAttribute("style"))&&(v==null?o.removeAttribute("style"):o.style.cssText=v),o.__style=l}return s}const ct=new Set;function ko(o,l,a,s,t=s){var v=a.getAttribute("type")==="checkbox",r=o;let c=!1;if(l!==null)for(var _ of l)r=r[_]??=[];r.push(a),co(a,"change",()=>{var d=a.__value;v&&(d=zt(r,d,a.checked)),t(d)},()=>t(v?[]:null)),ao(()=>{var d=s();if(Ke&&a.defaultChecked!==a.checked){c=!0;return}v?(d=d||[],a.checked=d.includes(a.__value)):a.checked=lo(a.__value,d)}),so(()=>{var d=r.indexOf(a);d!==-1&&r.splice(d,1)}),ct.has(r)||(ct.add(r),Ct(()=>{r.sort((d,w)=>d.compareDocumentPosition(w)===4?-1:1),ct.delete(r)})),Ct(()=>{if(c){var d;if(v)d=zt(r,d,a.checked);else{var w=r.find(h=>h.checked);d=w?.__value}t(d)}})}function zt(o,l,a){for(var s=new Set,t=0;t<o.length;t+=1)o[t].checked&&s.add(o[t].__value);return a||s.delete(l),Array.from(s)}function yo(o,l,a){console.log("[getAllValidMoves] Function called",{boardSize:a,blockedCellsCount:l.length});const s=[{dr:-1,dc:-1,dir:"7"},{dr:-1,dc:0,dir:"8"},{dr:-1,dc:1,dir:"9"},{dr:0,dc:-1,dir:"4"},{dr:0,dc:1,dir:"6"},{dr:1,dc:-1,dir:"1"},{dr:1,dc:0,dir:"2"},{dr:1,dc:1,dir:"3"}];let t=null;for(let r=0;r<a;r++){for(let c=0;c<a;c++)if(o[r][c]===1){t={row:r,col:c};break}if(t)break}if(console.log("[getAllValidMoves] Piece found:",t),!t)return console.log("[getAllValidMoves] No piece found on board"),[];const v=[];for(const{dr:r,dc:c,dir:_}of s)for(let d=1;d<a;d++){const w=t.row+r*d,h=t.col+c*d;if(w<0||h<0||w>=a||h>=a)break;l.some(m=>m.row===w&&m.col===h)||v.push({row:w,col:h,direction:_,distance:d})}return console.log("[getAllValidMoves] Generated moves:",v),v}function wo(o,l,a){console.log("[getRandomComputerMove] Function called",{boardSize:a,blockedCellsCount:l.length});const s=yo(o,l,a);if(console.log("[getRandomComputerMove] Available moves:",s),!s.length)return console.log("[getRandomComputerMove] No valid moves available"),null;const t=s[Math.floor(Math.random()*s.length)];return console.log("[getRandomComputerMove] Selected move:",t),t}const ft={isOpen:!1,title:"",content:"",buttons:[]},{subscribe:Vt,set:bt,update:cl}=nt(ft),Mo={subscribe:Vt};function Co({title:o,content:l,buttons:a}){bt({isOpen:!0,title:o,content:l,buttons:a||[]})}function So(){bt({...ft})}const ge={subscribe:Vt,showModal:Co,closeModal:()=>bt({...ft})},it=nt([]);let ot=!1;function dt(){if(typeof speechSynthesis>"u"||ot)return;const o=speechSynthesis.getVoices();o.length&&(console.log("[Speech] Voices loaded:",o.map(l=>({name:l.name,lang:l.lang,default:l.default}))),re.addLog(`[Speech] Loaded ${o.length} voices.`,"debug"),it.set(o),ot=!0,speechSynthesis.onvoiceschanged=null)}if(typeof window<"u"&&"speechSynthesis"in window&&(dt(),!ot)){speechSynthesis.onvoiceschanged=dt;const o=setInterval(()=>{ue(it).length>0?(ot=!0,clearInterval(o)):dt()},250);setTimeout(()=>clearInterval(o),3e3)}function zo(o){const l=ue(it);console.log(`[Speech] Filtering for langCode: "${o}". Total voices: ${l.length}`);const a=l.filter(s=>s.lang.startsWith(o));return console.log(`[Speech] Found ${a.length} voices for "${o}".`),a}function $o(o,l,a,s,t){if(typeof window>"u"||!("speechSynthesis"in window))return;const r=ue(rt)(`speech.directions.${l}`)||l;let c;a===1?c=`${r}.`:c=`${a} ${r}.`,window.speechSynthesis.cancel();const _=new SpeechSynthesisUtterance(c);if(_.lang=s,_.rate=1,_.pitch=1,t){const w=ue(it).find(h=>h.voiceURI===t);w?_.voice=w:console.warn(`[Speech] Voice with URI "${t}" not found.`)}console.log(`[Speech] Speaking: "${c}"`,{voice:_.voice?.name}),window.speechSynthesis.speak(_)}const Bo={uk:"uk-UA",en:"en-US",crh:"crh-UA",nl:"nl-NL"};function mt(o){return Array.from({length:o},()=>Array(o).fill(0))}function _t(o){return{row:Math.floor(Math.random()*o),col:Math.floor(Math.random()*o)}}function Ve(o,l,a,s=[]){const t=[],v=[[-1,0],[1,0],[0,-1],[0,1],[-1,-1],[-1,1],[1,-1],[1,1]],r=(c,_)=>s.some(d=>d.row===c&&d.col===_);for(const[c,_]of v)for(let d=1;d<a;d++){const w=o+c*d,h=l+_*d;if(w<0||h<0||w>=a||h>=a)break;r(w,h)||t.push({row:w,col:h})}return t}const $t={up:[-1,0],down:[1,0],left:[0,-1],right:[0,1],"up-left":[-1,-1],"up-right":[-1,1],"down-left":[1,-1],"down-right":[1,1]},Ze={1:"down-left",2:"down",3:"down-right",4:"left",6:"right",7:"up-left",8:"up",9:"up-right"},Do={up:"down",down:"up",left:"right",right:"left","up-left":"down-right","down-right":"up-left","up-right":"down-left","down-left":"up-right"},ht=typeof window<"u"&&typeof localStorage<"u",Bt=ht?localStorage.getItem("lang"):null,Dt=ht?localStorage.getItem("theme"):null,xt=ht?localStorage.getItem("style"):null,Xe=3,{row:Qe,col:Ye}=_t(Xe);console.log("[appState] Стартова позиція ферзя:",{initialRow:Qe,initialCol:Ye});const F=nt({currentView:"mainMenu",boardSize:Xe,gameMode:"vsComputer",language:Bt||"uk",theme:Dt||"dark",style:xt||"ubuntu",settings:{showMoves:!0,showBoard:!0,speechEnabled:!1,language:Bt||"uk",theme:Dt||"dark",style:xt||"ubuntu"},board:(()=>{const o=mt(Xe);return o[Qe][Ye]=1,o})(),playerRow:Qe,playerCol:Ye,blockedCells:[],availableMoves:Ve(Qe,Ye,Xe,[]),blockModeEnabled:!1,selectedDirection:null,selectedDistance:null,currentPlayer:1,lastMove:null,computerLastMoveDisplay:null,lastComputerMove:null,distanceManuallySelected:!1,visitedCells:[],isGameOver:!1,score:0,movesInBlockMode:0,jumpedBlockedCells:0,penaltyPoints:0,finishedByNoMovesButton:!1,gameId:1,availableDistances:[]}),xo=vo(F,o=>{const l=o.boardSize;return l<=1?[]:Array.from({length:l-1},(a,s)=>s+1)});function Pt(o,l,a){const{board:s,playerRow:t,playerCol:v,boardSize:r,blockModeEnabled:c,visitedCells:_,blockedCells:d}=o,w=s.map(f=>f.slice());w[t][v]=0,w[l][a]=1;let h=[..._],D=[...d];if(c){const f={row:t,col:v};D.some(j=>j.row===f.row&&j.col===f.col)||D.push(f),h.some(j=>j.row===f.row&&j.col===f.col)||h.push(f)}const m=Ve(l,a,r,D);return{board:w,playerRow:l,playerCol:a,blockedCells:D,visitedCells:h,availableMoves:m,lastMove:null}}function We(o){console.log("[setBoardSize] Function called with size:",o);const l=_t(o),a=l.row,s=l.col;F.update(t=>{const v=mt(o);return v[a][s]=1,console.log("[setBoardSize] Setting up new game",{boardSize:o,playerRow:a,playerCol:s,gameMode:t.gameMode}),{...t,boardSize:o,board:v,playerRow:a,playerCol:s,blockedCells:[],visitedCells:[],availableMoves:Ve(a,s,o,[]),blockModeEnabled:t.blockModeEnabled,distanceManuallySelected:!1,currentView:t.currentView,gameMode:t.gameMode,language:t.language,theme:t.theme,style:t.style,settings:{...t.settings},selectedDirection:null,selectedDistance:null,availableDistances:[1,2],currentPlayer:1,lastMove:null,computerLastMoveDisplay:null,lastComputerMove:null,score:0,isGameOver:!1,gameId:(t.gameId||0)+1}})}function Lo(o,l){F.update(a=>{const{board:s,boardSize:t,playerRow:v,playerCol:r,blockedCells:c}=a;if(Ve(v,r,t,c).some(d=>d.row===o&&d.col===l)){const d=s.map(f=>f.slice());d[v][r]=0,d[o][l]=1;const w=[...Ve(o,l,t,c)],h=o-v,D=l-r;let m=null;h<0&&D<0?m="up-left":h<0&&D===0?m="up":h<0&&D>0?m="up-right":h===0&&D<0?m="left":h===0&&D>0?m="right":h>0&&D<0?m="down-left":h>0&&D===0?m="down":h>0&&D>0&&(m="down-right");const g=Math.max(Math.abs(h),Math.abs(D));return{...a,board:d,playerRow:o,playerCol:l,availableMoves:w,currentPlayer:2,lastMove:m&&g?{direction:m,distance:g}:null,blockedCells:a.blockedCells,visitedCells:a.visitedCells,currentView:a.currentView,boardSize:a.boardSize,gameMode:a.gameMode,language:a.language,theme:a.theme,style:a.style,settings:{...a.settings},blockModeEnabled:a.blockModeEnabled,selectedDirection:a.selectedDirection??null,selectedDistance:a.selectedDistance??null,availableDistances:a.availableDistances,computerLastMoveDisplay:a.computerLastMoveDisplay,distanceManuallySelected:a.distanceManuallySelected,score:a.score,isGameOver:a.isGameOver}}return a})}function Ao(o,l){F.update(a=>{const s=a.blockedCells.some(r=>r.row===o&&r.col===l);let t;s?t=a.blockedCells.filter(r=>!(r.row===o&&r.col===l)):t=[...a.blockedCells,{row:o,col:l}];const v=Ve(a.playerRow,a.playerCol,a.boardSize,t);return{...a,blockedCells:t,availableMoves:v}})}function Rt(){F.update(o=>({...o,blockModeEnabled:!o.blockModeEnabled}))}function kt(){Vo(),ge.closeModal()}function Vo(){F.update(o=>{const l=o.boardSize,{row:a,col:s}=_t(l),t=mt(l);return t[a][s]=1,{...o,board:t,playerRow:a,playerCol:s,blockedCells:[],availableMoves:Ve(a,s,l,[]),visitedCells:[],currentView:o.currentView,boardSize:o.boardSize,gameMode:o.gameMode,language:o.language,theme:o.theme,style:o.style,settings:{...o.settings},blockModeEnabled:o.blockModeEnabled,selectedDirection:null,selectedDistance:null,distanceManuallySelected:!1,currentPlayer:1,lastMove:null,computerLastMoveDisplay:null,lastComputerMove:null,score:0,movesInBlockMode:0,jumpedBlockedCells:0,penaltyPoints:0,finishedByNoMovesButton:!1,isGameOver:!1,gameId:(o.gameId||0)+1}})}function at(o){const{score:l,penaltyPoints:a,boardSize:s,movesInBlockMode:t,finishedByNoMovesButton:v,jumpedBlockedCells:r}=o,c=l,_=a,d=s>2?(s-2)*10:0,w=Math.ceil(c*(d/100)),h=t,D=v?s:0,m=r,g=c+w+h+D+m-_;return{baseScore:c,totalPenalty:_,sizeBonus:w,blockModeBonus:h,noMovesBonus:D,jumpBonus:m,totalScore:g}}function Et(){if(console.log("[makeComputerMove] Function called"),typeof window>"u"){console.log("[makeComputerMove] Not in browser environment, skipping computer move");return}const o=()=>{const l=ue(F);console.log("[makeComputerMove] Current state:",{playerRow:l.playerRow,playerCol:l.playerCol,boardSize:l.boardSize,blockedCells:l.blockedCells});const a=wo(l.board,l.blockedCells,l.boardSize);if(a){console.log("[makeComputerMove] Computer move selected:",a),console.log("[makeComputerMove] Перед оновленням: move",a,"playerRow:",l.playerRow,"playerCol:",l.playerCol,"blockedCells:",l.blockedCells),F.update(v=>{const r=Pt(v,a.row,a.col),c=Object.prototype.hasOwnProperty.call(Ze,a.direction)?Ze[a.direction]:a.direction;return{...v,...r,currentPlayer:1,lastMove:null,computerLastMoveDisplay:{direction:c,distance:a.distance},lastComputerMove:{direction:c,distance:a.distance}}});const s=Object.prototype.hasOwnProperty.call(Ze,a.direction)?Ze[a.direction]:a.direction,t=ue(Ne);if(t.speechEnabled){const v=Bo[t.language]||"uk-UA";$o("computer",s,a.distance,v,t.selectedVoiceURI??null)}}else console.log("[makeComputerMove] No valid moves available for computer. Player wins!"),ge.showModal({title:"Комп'ютер не може зробити хід",content:"Ви можете очистити поле і продовжити гру, або завершити її зараз і отримати бонусні бали.",buttons:[{text:"Продовжити",primary:!0,isHot:!0,onClick:Tt,customClass:"green-btn"},{text:`Завершити (+${l.boardSize} балів)`,customClass:"blue-btn",onClick:Ut}]})};setTimeout(()=>{requestAnimationFrame(o)},600)}function Po(){Ne.update(o=>({...o,showMoves:!o.showMoves}))}function Ot(){Ne.update(o=>({...o,showBoard:!(o.showBoard??!0)}))}function Ro(){Ne.update(o=>({...o,speechEnabled:!o.speechEnabled}))}function Se(o){F.update(l=>{const{selectedDirection:a,selectedDistance:s,distanceManuallySelected:t,boardSize:v}=l,r=v-1;let c,_;return a!==o?(c=1,_=!1):t?(c=s,_=!0):(s==null||s>=r?c=1:c=s+1,_=!1),{...l,selectedDirection:o,selectedDistance:c,distanceManuallySelected:_,computerLastMoveDisplay:null}})}function Nt(o){F.update(l=>({...l,selectedDistance:o,distanceManuallySelected:!0,computerLastMoveDisplay:null}))}function jt(){if(typeof window>"u")return;const o=ue(F),{selectedDirection:l,selectedDistance:a,lastComputerMove:s,playerRow:t,playerCol:v,boardSize:r,blockedCells:c,settings:_,blockModeEnabled:d}=o;if(!l||!a)return;const w=l;if(!$t[w])return;const[h,D]=$t[w],m=t+h*a,g=v+D*a,f=m<0||m>=r||g<0||g>=r,j=c.some(S=>S.row===m&&S.col===g);let y=0;if(a>1)for(let S=1;S<a;S++){const q=t+h*S,Y=v+D*S;c.some(ee=>ee.row===q&&ee.col===Y)&&y++}let X=1,le=0;if(s&&a===s.distance&&l===Do[s.direction]&&(le=2,console.log("[confirmMove] Penalty applied for reverse move.")),f||j){const S=f?"Ви вийшли за межі дошки.":"Ви спробували стати на заблоковану клітинку.",q=at(o);F.update(Y=>({...Y,isGameOver:!0,score:q.totalScore})),ge.showModal({title:"Гру завершено!",content:{reason:S,scoreDetails:q},buttons:[{text:"Грати ще раз",primary:!0,onClick:kt,isHot:!0}]});return}F.update(S=>{const q=Pt(S,m,g);return{...S,...q,score:S.score+X,penaltyPoints:S.penaltyPoints+le,movesInBlockMode:d?S.movesInBlockMode+1:S.movesInBlockMode,jumpedBlockedCells:S.jumpedBlockedCells+y,selectedDirection:null,selectedDistance:null,distanceManuallySelected:!1,currentPlayer:2,lastMove:null,computerLastMoveDisplay:null}}),o.gameMode==="vsComputer"&&Et()}function Tt(){F.update(o=>{const l=[],a=Ve(o.playerRow,o.playerCol,o.boardSize,l);return So(),{...o,blockedCells:l,availableMoves:a}})}function Ut(){F.update(t=>({...t,finishedByNoMovesButton:!0}));const l=ue(F),a=at(l),s={...a,finishBonus:3,totalScore:a.totalScore+3};F.update(t=>({...t,isGameOver:!0,score:s.totalScore})),ge.showModal({title:"Гру завершено!",content:{reason:"Ви вирішили завершити гру та забрати бонус.",scoreDetails:s},buttons:[{text:"Грати ще раз",primary:!0,isHot:!0,onClick:kt,customClass:"green-btn"},{text:"Головне меню",customClass:"blue-btn",onClick:()=>{window.location.href="/"}}]})}function vt(){const o=ue(F);if(o.availableMoves.length===0){const l=at({...o,finishedByNoMovesButton:!0});ge.showModal({title:"Ходів немає. Що робити далі?",content:{reason:"Ви можете очистити поле і продовжити гру, або завершити її зараз і отримати бонусні бали.",scoreDetails:l},buttons:[{text:"Продовжити",primary:!0,isHot:!0,onClick:Tt,customClass:"green-btn"},{text:`Завершити (+${o.boardSize} балів)`,customClass:"blue-btn",onClick:Ut}]})}else{const l=at(o);F.update(a=>({...a,isGameOver:!0,score:l.totalScore})),ge.showModal({title:"Помилка!",content:{reason:`У вас ще є доступні ходи (${o.availableMoves.length} шт.). Ви програли.`,scoreDetails:l},buttons:[{text:"Грати ще раз",primary:!0,onClick:kt,isHot:!0}]})}}const yt=nt({isVoiceSettingsModalOpen:!1});function Eo(){yt.update(o=>({...o,isVoiceSettingsModalOpen:!0}))}function Oo(){yt.update(o=>({...o,isVoiceSettingsModalOpen:!1}))}function No(){Rt()}function jo(){Po()}function To(){Ot()}function Uo(){Ro()}function Go(){vt()}var Io=$('<label class="ios-switch-label svelte-gg7prz"><div class="ios-switch svelte-gg7prz"><input type="checkbox" class="svelte-gg7prz"/> <span class="slider svelte-gg7prz"></span></div> <span class="svelte-gg7prz"> </span></label>'),Ko=o=>{o.stopPropagation(),Eo()},Fo=(o,l)=>l("up-left"),Ho=(o,l)=>l("up"),qo=(o,l)=>l("up-right"),Zo=(o,l)=>l("left"),Wo=(o,l)=>l("right"),Jo=(o,l)=>l("down-left"),Xo=(o,l)=>l("down"),Qo=(o,l)=>l("down-right"),Yo=(o,l,a)=>l(e(a)),ea=$("<button> </button>"),ta=$('<div class="game-controls-panel svelte-gg7prz"><div class="toggles svelte-gg7prz"><!> <label class="ios-switch-label svelte-gg7prz"><div class="ios-switch svelte-gg7prz"><input type="checkbox" class="svelte-gg7prz"/> <span class="slider svelte-gg7prz"></span></div> <span class="svelte-gg7prz"> </span></label> <label class="ios-switch-label svelte-gg7prz"><div class="ios-switch svelte-gg7prz"><input type="checkbox" class="svelte-gg7prz"/> <span class="slider svelte-gg7prz"></span></div> <span class="svelte-gg7prz"> </span></label> <label class="ios-switch-label svelte-gg7prz"><div class="ios-switch svelte-gg7prz"><input type="checkbox" class="svelte-gg7prz"/> <span class="slider svelte-gg7prz"></span></div> <span class="svelte-gg7prz">Озвучування ходів</span> <button class="settings-icon-btn svelte-gg7prz" title="Налаштувати голос">⚙️</button></label></div> <div class="directions directions-3x3 svelte-gg7prz"><button>↖</button> <button>↑</button> <button>↗</button> <button>←</button> <button id="center-info" type="button" tabindex="0"> </button> <button>→</button> <button>↙</button> <button>↓</button> <button>↘</button></div> <div class="distance-select svelte-gg7prz"><div class="svelte-gg7prz"> </div> <div class="distance-btns svelte-gg7prz"></div></div> <div class="action-btns svelte-gg7prz"><button class="confirm-btn svelte-gg7prz"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" style="margin-right:8px;vertical-align:middle;" class="svelte-gg7prz"><path d="M5 13l4 4L19 7" stroke="#fff" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" class="svelte-gg7prz"></path></svg> </button> <button class="no-moves-btn svelte-gg7prz" title="Ходів немає"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" style="margin-right:8px;vertical-align:middle;" class="svelte-gg7prz"><path d="M18 6L6 18M6 6l12 12" stroke="#222" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" class="svelte-gg7prz"></path></svg> Ходів немає</button></div></div>');function oa(o,l){lt(l,!1);const[a,s]=gt(),t=()=>$e(F,"$appState",a),v=()=>$e(Ne,"$settingsStore",a),r=()=>$e(rt,"$_",a),c=()=>$e(xo,"$availableDistances",a),_=U(),d=U(),w=U(),h=U(),D=U(),m=U(),g=U(),f=U(),j=U(),y=U(),X={"up-left":"↖",up:"↑","up-right":"↗",left:"←",right:"→","down-left":"↙",down:"↓","down-right":"↘"};function le(){e(g)&&e(f)&&e(_)&&Y()}function S(p){Se(p)}function q(p){Nt(p)}function Y(){console.log("[GameControls] Confirm move button clicked",{selectedDirection:e(g),selectedDistance:e(f),buttonDisabled:e(j)}),jt()}K(()=>t(),()=>{O(_,t().currentPlayer===1)}),K(()=>t(),()=>{O(d,t().computerLastMoveDisplay)}),K(()=>t(),()=>{O(w,typeof t().blockModeEnabled=="boolean"?t().blockModeEnabled:!1)}),K(()=>t(),()=>{O(h,typeof t().settings?.showMoves=="boolean"?t().settings.showMoves:!0)}),K(()=>t(),()=>{O(D,typeof t().settings?.showBoard=="boolean"?t().settings.showBoard:!0)}),K(()=>v(),()=>{O(m,v().speechEnabled)}),K(()=>t(),()=>{O(g,t().selectedDirection||null)}),K(()=>t(),()=>{O(f,t().selectedDistance||null)}),K(()=>(e(g),e(f)),()=>{O(j,!e(g)||!e(f))}),K(()=>(e(g),e(f),e(j)),()=>{console.log("[GameControls] Button state changed:",{selectedDirection:e(g),selectedDistance:e(f),buttonDisabled:e(j)})}),K(()=>(e(g),e(f),e(d),e(_)),()=>{O(y,(()=>{if(!e(g)&&!e(f)&&!e(d))return{class:"",content:"",clickable:!1,aria:"Порожньо"};if(!e(g)&&!e(f)&&typeof e(d)=="object"&&e(d)!==null){let p="",A="";return typeof e(d).direction=="string"&&X.hasOwnProperty(e(d).direction)&&(p=X[e(d).direction]),typeof e(d).distance=="number"&&(A=e(d).distance),{class:"computer-move-display",content:`${p}${A}`,clickable:!1,aria:`Хід комп'ютера: ${p}${A}`}}if(e(g)&&!e(f)){let p="";return typeof e(g)=="string"&&X.hasOwnProperty(e(g))&&(p=X[e(g)]),{class:"direction-distance-state",content:p,clickable:!1,aria:`Вибрано напрямок: ${p}`}}if(!e(g)&&e(f))return{class:"direction-distance-state",content:String(e(f)),clickable:!1,aria:`Вибрано відстань: ${e(f)}`};if(e(g)&&e(f)){let p="";return typeof e(g)=="string"&&X.hasOwnProperty(e(g))&&(p=X[e(g)]),{class:"confirm-btn-active",content:`${p}${String(e(f))}`,clickable:e(_),aria:`Підтвердити хід: ${p}${e(f)}`}}return{class:"",content:"",clickable:!1,aria:""}})())}),At(),pt();var ee=ta(),te=i(ee),fe=i(te);{var be=p=>{var A=Io(),R=i(A),Me=i(R);Ie(Me),Me.__change=[jo],Ge(2),n(R);var Le=u(R,2),Te=i(Le,!0);n(Le),n(A),I(ae=>{qe(Me,e(h)),E(Te,ae)},[()=>(r(),N(()=>r()("gameControls.showMoves")))],Je),C(p,A)};T(fe,p=>{e(D)&&p(be)})}var me=u(fe,2),_e=i(me),ke=i(_e);Ie(ke),ke.__change=[To],Ge(2),n(_e);var Be=u(_e,2),P=i(Be,!0);n(Be),n(me);var M=u(me,2),Z=i(M),ie=i(Z);Ie(ie),ie.__change=[No],Ge(2),n(Z);var oe=u(Z,2),se=i(oe,!0);n(oe),n(M);var G=u(M,2),H=i(G),x=i(H);Ie(x),x.__change=[Uo],Ge(2),n(H);var Q=u(H,4);Q.__click=[Ko],n(G),n(te);var ce=u(te,2),ne=i(ce);ne.__click=[Fo,S];var ye=u(ne,2);ye.__click=[Ho,S];var Pe=u(ye,2);Pe.__click=[qo,S];var De=u(Pe,2);De.__click=[Zo,S];var he=u(De,2);he.__click=function(...p){(e(y).clickable?le:void 0)?.apply(this,p)};var je=i(he,!0);n(he);var xe=u(he,2);xe.__click=[Wo,S];var we=u(xe,2);we.__click=[Jo,S];var Re=u(we,2);Re.__click=[Xo,S];var Ee=u(Re,2);Ee.__click=[Qo,S],n(ce);var b=u(ce,2),k=i(b),L=i(k,!0);n(k);var B=u(k,2);Ue(B,5,c,tt,(p,A)=>{var R=ea();R.__click=[Yo,q,A];var Me=i(R,!0);n(R),I((Le,Te,ae)=>{de(R,1,`dist-btn ${e(f)===e(A)?"active":""}`,"svelte-gg7prz"),uo(R,Le),ve(R,"id",Te),E(Me,ae)},[()=>(e(A),N(()=>String(e(A)))),()=>(e(A),N(()=>String(e(A)))),()=>(e(A),N(()=>String(e(A))))],Je),C(p,R)}),n(B),n(b);var W=u(b,2),J=i(W);J.__click=Y;var z=u(i(J));n(J);var V=u(J,2);V.__click=[Go],n(W),n(ee),I((p,A,R,Me,Le,Te)=>{qe(ke,e(D)),E(P,p),qe(ie,e(w)),E(se,A),qe(x,e(m)),Q.disabled=!e(m),de(ne,1,`dir-btn ${e(g)==="up-left"?"active":""}`,"svelte-gg7prz"),de(ye,1,`dir-btn ${e(g)==="up"?"active":""}`,"svelte-gg7prz"),de(Pe,1,`dir-btn ${e(g)==="up-right"?"active":""}`,"svelte-gg7prz"),de(De,1,`dir-btn ${e(g)==="left"?"active":""}`,"svelte-gg7prz"),de(he,1,`control-btn center-info ${e(y),N(()=>e(y).class)??""}`,"svelte-gg7prz"),ve(he,"aria-label",(e(y),N(()=>e(y).aria))),he.disabled=(e(y),N(()=>!e(y).clickable)),E(je,R),de(xe,1,`dir-btn ${e(g)==="right"?"active":""}`,"svelte-gg7prz"),de(we,1,`dir-btn ${e(g)==="down-left"?"active":""}`,"svelte-gg7prz"),de(Re,1,`dir-btn ${e(g)==="down"?"active":""}`,"svelte-gg7prz"),de(Ee,1,`dir-btn ${e(g)==="down-right"?"active":""}`,"svelte-gg7prz"),E(L,Me),J.disabled=e(j),ve(J,"title",Le),E(z,` ${Te??""}`)},[()=>(r(),N(()=>r()("gameControls.showBoard"))),()=>(r(),N(()=>r()("gameControls.blockMode"))),()=>(e(y),N(()=>String(e(y).content))),()=>(r(),N(()=>r()("gameControls.selectDistance"))),()=>(r(),N(()=>r()("gameControls.confirm"))),()=>(r(),N(()=>r()("gameControls.confirm")))],Je),C(o,ee),st(),s()}ut(["change","click"]);function aa(o,l,a){if(!l().isOpen||!l().buttons)return;const s=l().buttons.findIndex(t=>t.isHot);if(s!==-1&&(o.key==="Enter"||o.key===" "||o.key==="5")){o.preventDefault(),o.stopPropagation();const t=l().buttons[s];t&&typeof t.onClick=="function"?t.onClick():ge.closeModal()}}var la=(o,l,a,s)=>{l().title!=="Гру завершено!"&&s(o)},sa=$('<span class="modal-victory-icon svelte-17pm6zg">👑</span>'),na=()=>{re.addLog("Закриття модального вікна (X)","info"),ge.closeModal()},ra=$('<button class="modal-close svelte-17pm6zg">&times;</button>'),ia=$('<p class="reason svelte-17pm6zg"> </p>'),ca=$('<div class="svelte-17pm6zg">Бонус за розмір дошки: <span class="svelte-17pm6zg"> </span></div>'),da=$('<div class="svelte-17pm6zg">Бонус за режим блокування: <span class="svelte-17pm6zg"> </span></div>'),va=$('<div class="svelte-17pm6zg">Бонус за стрибки: <span class="svelte-17pm6zg"> </span></div>'),ua=$('<div class="svelte-17pm6zg">Бонус "Ходів немає": <span class="svelte-17pm6zg"> </span></div>'),pa=$('<div class="svelte-17pm6zg">Бонус за завершення гри: <span class="svelte-17pm6zg"> </span></div>'),ga=$('<div class="penalty svelte-17pm6zg">Штраф за зворотні ходи: <span class="svelte-17pm6zg"> </span></div>'),fa=$('<div class="score-breakdown svelte-17pm6zg"><div class="svelte-17pm6zg">Базовий рахунок: <span class="svelte-17pm6zg"> </span></div> <!> <!> <!> <!> <!> <!></div> <div class="final-score-container svelte-17pm6zg"><span class="score-label svelte-17pm6zg">Підсумковий рахунок:</span> <span class="score-value svelte-17pm6zg"> </span></div>',1),ba=$("<!> <!>",1),ma=$('<p class="reason svelte-17pm6zg"> </p> <div class="final-score-container svelte-17pm6zg"><span class="score-label svelte-17pm6zg">Ваш рахунок:</span> <span class="score-value svelte-17pm6zg"> </span></div>',1),_a=$('<div class="modal-info svelte-17pm6zg"> </div>'),ha=(o,l)=>{re.addLog(`Клік по кнопці модалки: ${e(l).text}`,"info"),(e(l).onClick||ge.closeModal)()},ka=$('<button data-role="modal-btn" aria-pressed="false" tabindex="0"> </button>'),ya=(o,l)=>{re.addLog(`Клік по кнопці модалки: ${e(l).text}`,"info"),(e(l).onClick||ge.closeModal)()},wa=$('<button data-role="modal-btn" aria-pressed="false" tabindex="-1"> </button>'),Ma=()=>{re.addLog("Закриття модального вікна (OK)","info"),ge.closeModal()},Ca=$('<button class="modal-btn-generic svelte-17pm6zg" data-testid="modal-btn-ok" data-role="modal-btn"> </button>'),Sa=$('<div class="modal-overlay svelte-17pm6zg" role="button" tabindex="0"><div class="modal-window svelte-17pm6zg"><div class="modal-header svelte-17pm6zg"><!> <h2 class="modal-title svelte-17pm6zg"> </h2> <!></div> <div class="modal-content svelte-17pm6zg"><!></div> <div class="modal-buttons svelte-17pm6zg"><!> <!></div></div></div>');function za(o,l){lt(l,!0);const[a,s]=gt(),t=()=>$e(e(r),"$modal_data",a),v=()=>$e(rt,"$_",a),r=St(()=>Mo),c=St(()=>()=>typeof t().content=="object"&&t().content!==null&&t().content.scoreDetails?t().content.scoreDetails:null);let _=ro(null);no(()=>{t().isOpen&&e(_)&&setTimeout(()=>{e(_)?.focus()},50)});function d(m){if(t().buttons&&t().buttons.length===2&&t().buttons.every(f=>typeof f.onClick=="function"))return;const g=m.target;g&&g.classList.contains("modal-overlay")&&(re.addLog("Закриття модального вікна (overlay)","info"),ge.closeModal())}var w=et(),h=ze(w);{var D=m=>{var g=Sa();g.__click=[la,t,r,d],g.__keydown=[aa,t,r];var f=i(g),j=i(f),y=i(j);{var X=P=>{var M=sa();C(P,M)};T(y,P=>{t().title&&(t().title.includes("перемогли")||t().title.includes("Комп"))&&P(X)})}var le=u(y,2),S=i(le,!0);n(le);var q=u(le,2);{var Y=P=>{var M=ra();M.__click=[na],C(P,M)};T(q,P=>{t().buttons&&t().buttons.length===2&&t().buttons.every(M=>typeof M.onClick=="function")||t().title==="Гру завершено!"||P(Y)})}n(j);var ee=u(j,2),te=i(ee);{var fe=P=>{var M=ba(),Z=ze(M);{var ie=G=>{var H=ia(),x=i(H,!0);n(H),I(()=>E(x,t().content.reason)),C(G,H)};T(Z,G=>{typeof t().content=="object"&&t().content!==null&&G(ie)})}var oe=u(Z,2);{var se=G=>{var H=fa(),x=ze(H),Q=i(x),ce=u(i(Q)),ne=i(ce,!0);n(ce),n(Q);var ye=u(Q,2);{var Pe=z=>{var V=ca(),p=u(i(V)),A=i(p);n(p),n(V),I(R=>E(A,`+${R??""}`),[()=>e(c)().sizeBonus]),C(z,V)};T(ye,z=>{e(c)().sizeBonus>0&&z(Pe)})}var De=u(ye,2);{var he=z=>{var V=da(),p=u(i(V)),A=i(p);n(p),n(V),I(R=>E(A,`+${R??""}`),[()=>e(c)().blockModeBonus]),C(z,V)};T(De,z=>{e(c)().blockModeBonus>0&&z(he)})}var je=u(De,2);{var xe=z=>{var V=va(),p=u(i(V)),A=i(p);n(p),n(V),I(R=>E(A,`+${R??""}`),[()=>e(c)().jumpBonus]),C(z,V)};T(je,z=>{e(c)().jumpBonus>0&&z(xe)})}var we=u(je,2);{var Re=z=>{var V=ua(),p=u(i(V)),A=i(p);n(p),n(V),I(R=>E(A,`+${R??""}`),[()=>e(c)().noMovesBonus]),C(z,V)};T(we,z=>{e(c)().noMovesBonus>0&&z(Re)})}var Ee=u(we,2);{var b=z=>{var V=pa(),p=u(i(V)),A=i(p);n(p),n(V),I(R=>E(A,`+${R??""}`),[()=>e(c)().finishBonus]),C(z,V)};T(Ee,z=>{e(c)().finishBonus>0&&z(b)})}var k=u(Ee,2);{var L=z=>{var V=ga(),p=u(i(V)),A=i(p);n(p),n(V),I(R=>E(A,`-${R??""}`),[()=>e(c)().totalPenalty]),C(z,V)};T(k,z=>{e(c)().totalPenalty>0&&z(L)})}n(x);var B=u(x,2),W=u(i(B),2),J=i(W,!0);n(W),n(B),I((z,V)=>{E(ne,z),E(J,V)},[()=>e(c)().baseScore,()=>e(c)().totalScore]),C(G,H)};T(oe,G=>{e(c)()&&G(se)})}C(P,M)},be=(P,M)=>{{var Z=oe=>{var se=ma(),G=ze(se),H=i(G,!0);n(G);var x=u(G,2),Q=u(i(x),2),ce=i(Q,!0);n(Q),n(x),I(()=>{E(H,t().content.reason),E(ce,t().content.score)}),C(oe,se)},ie=oe=>{var se=_a(),G=i(se,!0);n(se),I(()=>E(G,t().content)),C(oe,se)};T(P,oe=>{typeof t().content=="object"&&t().content!==null&&t().content.score?oe(Z):oe(ie,!1)},M)}};T(te,P=>{e(c)?P(fe):P(be,!1)})}n(ee);var me=u(ee,2),_e=i(me);Ue(_e,1,()=>t().buttons,tt,(P,M,Z)=>{var ie=et(),oe=ze(ie);{var se=H=>{var x=ka();let Q;ve(x,"data-testid",`modal-btn-${Z}`),x.__click=[ha,M];var ce=i(x,!0);n(x),bo(x,ne=>O(_,ne),()=>e(_)),I(ne=>{Q=de(x,1,"modal-btn-generic svelte-17pm6zg",null,Q,ne),ve(x,"aria-label",e(M).text),E(ce,e(M).text)},[()=>({primary:e(M).primary&&!e(M).customClass,"blue-btn":e(M).customClass==="blue-btn","green-btn":e(M).customClass==="green-btn"})]),C(H,x)},G=H=>{var x=wa();let Q;ve(x,"data-testid",`modal-btn-${Z}`),x.__click=[ya,M];var ce=i(x,!0);n(x),I(ne=>{Q=de(x,1,"modal-btn-generic svelte-17pm6zg",null,Q,ne),ve(x,"aria-label",e(M).text),E(ce,e(M).text)},[()=>({primary:e(M).primary&&!e(M).customClass,"blue-btn":e(M).customClass==="blue-btn","green-btn":e(M).customClass==="green-btn"})]),C(H,x)};T(oe,H=>{e(M).isHot?H(se):H(G,!1)})}C(P,ie)});var ke=u(_e,2);{var Be=P=>{var M=Ca();M.__click=[Ma];var Z=i(M,!0);n(M),I(ie=>E(Z,ie),[()=>v()("modal.ok")]),C(P,M)};T(ke,P=>{t().buttons.length||P(Be)})}n(me),n(f),n(g),I(P=>{ve(g,"aria-label",P),E(S,t().title)},[()=>v()("modal.close")]),C(m,g)};T(h,m=>{t().isOpen&&m(D)})}C(o,w),st(),s()}ut(["click","keydown"]);function $a(o,l){Ne.updateSettings({selectedVoiceURI:e(l)})}var Ba=o=>o.stopPropagation(),Da=$('<div class="loader-container svelte-ld5wmd"><div class="loading-spinner svelte-ld5wmd"></div> <p>Завантаження голосів...</p></div>'),xa=$('<label class="voice-option svelte-ld5wmd"><input type="radio" name="voice" class="svelte-ld5wmd"/> <span class="voice-name svelte-ld5wmd"> </span></label>'),La=$('<div class="voice-list svelte-ld5wmd" role="radiogroup" aria-labelledby="voice-settings-title"></div>'),Aa=$('<p class="no-voices-message svelte-ld5wmd">Українські голоси не знайдено у вашому браузері. Озвучування буде стандартним голосом системи.</p>'),Va=$('<div class="modal-overlay svelte-ld5wmd"><div class="modal-window svelte-ld5wmd"><div class="modal-header svelte-ld5wmd"><h2 class="modal-title svelte-ld5wmd">Налаштування голосу</h2> <button class="modal-close svelte-ld5wmd">&times;</button></div> <div class="modal-body svelte-ld5wmd"><!></div> <div class="modal-footer svelte-ld5wmd"><button class="modal-btn-generic primary svelte-ld5wmd">Закрити</button></div></div></div>');function Pa(o,l){lt(l,!1);const a=[];let s=mo(l,"close",8,()=>{}),t=U(!0),v=U([]),r=U(ue(Ne).selectedVoiceURI);Lt(async()=>{if(ue(go)==="uk")try{O(v,zo("uk"))}catch(y){console.error("Помилка завантаження голосів:",y)}O(t,!1)}),pt();var c=Va();c.__click=[function(...y){s()?.apply(this,y)}];var _=i(c);_.__click=[Ba];var d=i(_),w=u(i(d),2);w.__click=[function(...y){s()?.apply(this,y)}],n(d);var h=u(d,2),D=i(h);{var m=y=>{var X=Da();C(y,X)},g=(y,X)=>{{var le=q=>{var Y=La();Ue(Y,5,()=>e(v),ee=>ee.voiceURI,(ee,te)=>{var fe=xa(),be=i(fe);Ie(be),be.__change=[$a,r];var me,_e=u(be,2),ke=i(_e,!0);n(_e),n(fe),I(()=>{me!==(me=(e(te),N(()=>e(te).voiceURI)))&&(be.value=(be.__value=(e(te),N(()=>e(te).voiceURI)))??""),E(ke,(e(te),N(()=>e(te).name)))}),ko(a,[],be,()=>(e(te),N(()=>e(te).voiceURI),e(r)),Be=>O(r,Be)),C(ee,fe)}),n(Y),C(q,Y)},S=q=>{var Y=Aa();C(q,Y)};T(y,q=>{e(v),N(()=>e(v).length>0)?q(le):q(S,!1)},X)}};T(D,y=>{e(t)?y(m):y(g,!1)})}n(h);var f=u(h,2),j=i(f);j.__click=[function(...y){s()?.apply(this,y)}],n(f),n(_),n(c),C(o,c),st()}ut(["click","change"]);var Ra=$('<li role="option"> </li>'),Ea=$('<div class="dropdown-backdrop"></div> <ul class="board-size-dropdown-list" role="listbox"></ul>',1),Oa=$('<span class="penalty-display svelte-1fu0r1w"> </span>'),Na=$('<span class="blocked-x">✗</span>'),ja=$('<span class="crown">👑</span>'),Ta=$('<span class="move-dot"></span>'),Ua=$("<!> <!>",1),Ga=$('<div role="button" tabindex="0"><!></div>'),Ia=$('<div class="board-bg-wrapper"><div class="game-board"></div></div>'),Ka=$('<div class="game-board-container"><div class="game-board-top-row"><button class="main-menu-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="#000000" viewBox="0 0 547.596 547.596" width="32" height="32" class="main-menu-btn-img"><g><path d="M540.76,254.788L294.506,38.216c-11.475-10.098-30.064-10.098-41.386,0L6.943,254.788   c-11.475,10.098-8.415,18.284,6.885,18.284h75.964v221.773c0,12.087,9.945,22.108,22.108,22.108h92.947V371.067   c0-12.087,9.945-22.108,22.109-22.108h93.865c12.239,0,22.108,9.792,22.108,22.108v145.886h92.947   c12.24,0,22.108-9.945,22.108-22.108v-221.85h75.965C549.021,272.995,552.081,264.886,540.76,254.788z"></path></g></svg></button> <button class="clear-cache-btn svelte-1fu0r1w" aria-label="Очистити кеш" title="Очистити кеш"><svg width="64" height="64" viewBox="0 0 16 16" fill="none"><path fill="#000000" d="M13.9907,0 C14.8816,0 15.3277,1.07714 14.6978,1.70711 L13.8556,2.54922 C14.421,3.15654 14.8904,3.85028 15.2448,4.60695 C15.8028,5.79836 16.0583,7.109 15.9888,8.42277 C15.9193,9.73654 15.5268,11.0129 14.8462,12.1388 C14.1656,13.2646 13.2178,14.2053 12.0868,14.8773 C10.9558,15.5494 9.67655,15.9322 8.3623,15.9918 C7.04804,16.0514 5.73937,15.7859 4.55221,15.2189 C3.36505,14.652 2.33604,13.8009 1.55634,12.7413 C0.776635,11.6816 0.270299,10.446 0.0821822,9.14392 C0.00321229,8.59731 0.382309,8.09018 0.928918,8.01121 C1.47553,7.93224 1.98266,8.31133 2.06163,8.85794 C2.20272,9.83451 2.58247,10.7612 3.16725,11.556 C3.75203,12.3507 4.52378,12.989 5.41415,13.4142 C6.30452,13.8394 7.28602,14.0385 8.27172,13.9939 C9.25741,13.9492 10.2169,13.6621 11.0651,13.158 C11.9133,12.6539 12.6242,11.9485 13.1346,11.1041 C13.6451,10.2597 13.9395,9.30241 13.9916,8.31708 C14.0437,7.33175 13.8521,6.34877 13.4336,5.45521 C13.178,4.90949 12.8426,4.40741 12.4402,3.96464 L11.7071,4.69779 C11.0771,5.32776 9.99996,4.88159 9.99996,3.99069 L9.99996,0 L13.9907,0 Z M1.499979,4 C2.05226,4 2.499979,4.44772 2.499979,5 C2.499979,5.55229 2.05226,6 1.499979,6 C0.947694,6 0.499979,5.55228 0.499979,5 C0.499979,4.44772 0.947694,4 1.499979,4 Z M3.74998,1.25 C4.30226,1.25 4.74998,1.69772 4.74998,2.25 C4.74998,2.80229 4.30226,3.25 3.74998,3.25 C3.19769,3.25 2.74998,2.80228 2.74998,2.25 C2.74998,1.69772 3.19769,1.25 3.74998,1.25 Z M6.99998,0 C7.55226,0 7.99998,0.447716 7.99998,1 C7.99998,1.55229 7.55226,2 6.99998,2 C6.44769,2 5.99998,1.55229 5.99998,1 C5.99998,0.447716 6.44769,0 6.99998,0 Z"></path></svg></button> <div class="board-size-dropdown-wrapper"><button class="board-size-dropdown-btn" aria-haspopup="listbox"><span class="board-size-dropdown-btn-text"> </span> <svg width="18" height="18" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z" fill="currentColor"></path></svg></button> <!></div></div> <div class="score-panel svelte-1fu0r1w"> <!></div> <!> <!> <!> <!></div>');function Fa(o,l){lt(l,!1);const[a,s]=gt(),t=()=>$e(F,"$appState",a),v=()=>$e(rt,"$_",a),r=()=>$e(yt,"$uiState",a),c=U(),_=U(),d=U(),w=U();function h(){if(localStorage.clear(),sessionStorage.clear(),document.cookie&&document.cookie!==""){const b=document.cookie.split(";");for(let k=0;k<b.length;k++){const L=b[k],B=L.indexOf("="),W=B>-1?L.substr(0,B):L;document.cookie=W+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/"}}location.reload()}let D=Array.from({length:8},(b,k)=>k+2),m=U(),g=U(),f=U(),j=U(),y=U(),X=U(),le=U(),S=U(!1);function q(){O(S,!e(S))}function Y(){O(S,!1)}function ee(b){We(b),O(S,!1)}Lt(()=>{(!e(g)||!Array.isArray(e(g))||e(g).length===0)&&(re.addLog("Дошка не ініціалізована, створюю дефолтну 3x3","warn"),We(3))});function te(){re.addLog("Повернення до головного меню","info"),fo("/")}function fe(b,k){const L=t().availableMoves&&t().availableMoves.some(B=>B.row===b&&B.col===k);return console.log("[isAvailable] row:",b,"col:",k,"result:",L,"availableMoves:",t().availableMoves),L}function be(b,k){const L=e(y)&&e(y).some(B=>Number(B.row)===Number(b)&&Number(B.col)===Number(k));return console.log("[isBlocked]",{row:b,col:k,blockedCells:e(y),result:L}),L}function me(b,k){return!!(e(y)&&e(y).some(L=>L.row===b&&L.col===k))}function _e(b,k){fe(b,k)&&!be(b,k)&&(re.addLog(`Рух гравця на клітинку [${b},${k}]`,"info"),Lo(b,k),t().gameMode==="vsComputer"&&Et())}function ke(b,k,L){if(b.preventDefault(),e(X)&&!(k===e(f)&&L===e(j))){const B=e(y)&&e(y).some(W=>W.row===k&&W.col===L);re.addLog(`${B?"Розблокування":"Блокування"} клітинки [${k},${L}]`,"info"),Ao(k,L)}}function Be(b){if(ue(ge).isOpen)return;const k=b.target;if(k&&typeof k=="object"&&"tagName"in k){const B=k.tagName;if(B==="INPUT"||B==="TEXTAREA"||B==="SELECT")return}let L=!0;switch(b.key){case"ArrowUp":case"8":Se("up");break;case"ArrowDown":case"2":Se("down");break;case"ArrowLeft":case"4":Se("left");break;case"ArrowRight":case"6":Se("right");break;case"7":Se("up-left");break;case"9":Se("up-right");break;case"1":t().selectedDirection?Nt(1):Se("down-left");break;case"3":Se("down-right");break;case"Enter":case" ":case"5":jt();break;case"n":case"N":vt();break;case"Backspace":re.addLog('[handleKeydown] Натиснуто Backspace — заявити "немає ходів"',"info"),vt();break;case"*":re.addLog("[handleKeydown] Перемкнено режим заблокованих клітинок","info"),Rt();break;case"/":re.addLog("[handleKeydown] Перемкнено видимість дошки","info"),Ot();break;case"+":{const B=ue(F).boardSize;B<9&&(re.addLog(`[handleKeydown] Збільшено розмір дошки до ${B+1}`,"info"),We(B+1))}break;case"-":{const B=ue(F).boardSize;B>2&&(re.addLog(`[handleKeydown] Зменшено розмір дошки до ${B-1}`,"info"),We(B-1))}break;default:L=!1;break}L&&b.preventDefault()}K(()=>t(),()=>{O(m,Number(t().boardSize))}),K(()=>t(),()=>{O(g,t().board)}),K(()=>t(),()=>{O(f,t().playerRow)}),K(()=>t(),()=>{O(j,t().playerCol)}),K(()=>t(),()=>{O(y,t().blockedCells)}),K(()=>t(),()=>{O(X,t().blockModeEnabled)}),K(()=>t(),()=>{O(le,t().currentPlayer)}),K(()=>t(),()=>{O(c,t().settings?.showMoves)}),K(()=>t(),()=>{O(_,typeof t().settings?.showBoard=="boolean"?t().settings.showBoard:!0)}),K(()=>(e(f),e(j),t(),e(y)),()=>{console.log("[GameBoard] playerRow:",e(f),"playerCol:",e(j),"availableMoves:",t().availableMoves,"blockedCells:",e(y))}),K(()=>v(),()=>{O(d,v()("gameBoard.player"))}),K(()=>v(),()=>{O(w,v()("gameBoard.mainMenu"))}),At(),pt();var P=Ka();Ce("keydown",io,Be);var M=i(P),Z=i(M),ie=i(Z);n(Z);var oe=u(Z,2),se=u(oe,2),G=i(se),H=i(G),x=i(H,!0);n(H),Ge(2),n(G);var Q=u(G,2);{var ce=b=>{var k=Ea(),L=ze(k),B=u(L,2);Ue(B,5,()=>D,W=>W,(W,J)=>{var z=Ra(),V=i(z);n(z),I(()=>{de(z,1,`board-size-dropdown-option ${e(J)===e(m)?"selected":""}`),ve(z,"aria-selected",e(J)===e(m)),E(V,`${e(J)??""}x${e(J)??""}`)}),Ce("click",z,()=>ee(e(J))),C(W,z)}),n(B),Ce("click",L,Y),C(b,k)};T(Q,b=>{e(S)&&b(ce)})}n(se),n(M);var ne=u(M,2),ye=i(ne),Pe=u(ye);{var De=b=>{var k=Oa(),L=i(k);n(k),I(()=>E(L,`-${t(),N(()=>t().penaltyPoints)??""}`)),C(b,k)};T(Pe,b=>{t(),N(()=>t().penaltyPoints>0)&&b(De)})}n(ne);var he=u(ne,2);{var je=b=>{var k=et(),L=ze(k);_o(L,()=>(t(),N(()=>`${t().boardSize}-${t().gameId}`)),B=>{var W=Ia(),J=i(W);Ue(J,5,()=>(e(m),N(()=>Array(e(m)))),tt,(z,V,p,A)=>{var R=et(),Me=ze(R);Ue(Me,1,()=>(e(m),N(()=>Array(e(m)))),tt,(Le,Te,ae,Ha)=>{var Ae=Ga();let wt;ve(Ae,"aria-label",`Cell ${p+1}, ${ae+1}`);var Gt=i(Ae);{var It=pe=>{var Fe=Na();C(pe,Fe)},Kt=pe=>{var Fe=Ua(),Mt=ze(Fe);{var Ft=Oe=>{var He=ja();I(()=>ve(He,"title",e(d))),C(Oe,He)};T(Mt,Oe=>{p===e(f)&&ae===e(j)&&Oe(Ft)})}var Ht=u(Mt,2);{var qt=Oe=>{var He=Ta();C(Oe,He)};T(Ht,Oe=>{e(le),e(c),N(()=>fe(p,ae)&&e(le)===1&&e(c))&&Oe(qt)})}C(pe,Fe)};T(Gt,pe=>{N(()=>me(p,ae))?pe(It):pe(Kt,!1)})}n(Ae),I(pe=>wt=de(Ae,1,"board-cell",null,wt,pe),[()=>({light:(p+ae)%2===0,dark:(p+ae)%2!==0,"player-piece":p===e(f)&&ae===e(j),"blocked-cell":me(p,ae),available:e(c)&&fe(p,ae)&&e(le)===1})],Je),Ce("click",Ae,()=>_e(p,ae)),Ce("contextmenu",Ae,pe=>ke(pe,p,ae)),Ce("keydown",Ae,pe=>{(pe.key==="Enter"||pe.key===" ")&&_e(p,ae)}),C(Le,Ae)}),C(z,R)}),n(J),n(W),I(()=>ho(J,`--board-size: ${e(m)??""}`)),C(B,W)}),C(b,k)};T(he,b=>{e(_)&&b(je)})}var xe=u(he,2);oa(xe,{});var we=u(xe,2);za(we,{});var Re=u(we,2);{var Ee=b=>{Pa(b,{get close(){return Oo}})};T(Re,b=>{r(),N(()=>r().isVoiceSettingsModalOpen)&&b(Ee)})}n(P),I(()=>{ve(Z,"title",e(w)),ve(ie,"aria-label",e(w)),ve(G,"aria-expanded",e(S)),E(x,e(m)),E(ye,`Рахунок: ${t(),N(()=>t().score)??""} `)}),Ce("click",Z,te),Ce("click",oe,h),Ce("click",G,q),C(o,P),st(),s()}function dl(o){Fa(o,{})}export{dl as component};
