<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –æ–∑–≤—É—á—É–≤–∞–Ω–Ω—è</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 8px;
        }
        button {
            margin: 5px;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background: #007bff;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>–¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ –æ–∑–≤—É—á—É–≤–∞–Ω–Ω—è</h1>
    
    <div class="test-section">
        <h2>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ Web Speech API</h2>
        <div id="speech-support-status" class="status"></div>
        <button onclick="checkSpeechSupport()">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫—É</button>
    </div>

    <div class="test-section">
        <h2>–¢–µ—Å—Ç –æ–∑–≤—É—á—É–≤–∞–Ω–Ω—è —Ö–æ–¥—ñ–≤</h2>
        <div>
            <label>–ù–∞–ø—Ä—è–º–æ–∫:</label>
            <select id="direction-select">
                <option value="1" data-uk="–≤–Ω–∏–∑-–ª—ñ–≤–æ—Ä—É—á" data-en="down-left" data-crh="a≈üaƒüƒ±-sol" data-nl="omlaag-links">1</option>
                <option value="2" data-uk="–≤–Ω–∏–∑" data-en="down" data-crh="a≈üaƒüƒ±" data-nl="omlaag">2</option>
                <option value="3" data-uk="–≤–Ω–∏–∑-–ø—Ä–∞–≤–æ—Ä—É—á" data-en="down-right" data-crh="a≈üaƒüƒ±-saƒü" data-nl="omlaag-rechts">3</option>
                <option value="4" data-uk="–ª—ñ–≤–æ—Ä—É—á" data-en="left" data-crh="sol" data-nl="links">4</option>
                <option value="6" data-uk="–ø—Ä–∞–≤–æ—Ä—É—á" data-en="right" data-crh="saƒü" data-nl="rechts">6</option>
                <option value="7" data-uk="–≤–≥–æ—Ä—É-–ª—ñ–≤–æ—Ä—É—á" data-en="up-left" data-crh="yukarƒ±-sol" data-nl="omhoog-links">7</option>
                <option value="8" data-uk="–≤–≥–æ—Ä—É" data-en="up" data-crh="yukarƒ±" data-nl="omhoog">8</option>
                <option value="9" data-uk="–≤–≥–æ—Ä—É-–ø—Ä–∞–≤–æ—Ä—É—á" data-en="up-right" data-crh="yukarƒ±-saƒü" data-nl="omhoog-rechts">9</option>
            </select>
        </div>
        <div>
            <label>–í—ñ–¥—Å—Ç–∞–Ω—å:</label>
            <select id="distance-select">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
        </div>
        <div>
            <label>–ú–æ–≤–∞:</label>
            <select id="lang-select">
                <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
                <option value="en">English</option>
                <option value="crh">–ö—Ä–∏–º—Å—å–∫–æ—Ç–∞—Ç–∞—Ä—Å—å–∫–∞</option>
                <option value="nl">Nederlands</option>
            </select>
        </div>
        <button onclick="testMoveSpeech()">–û–∑–≤—É—á–∏—Ç–∏ —Ö—ñ–¥</button>
        <div id="move-speech-status" class="status"></div>
    </div>

    <div class="test-section">
        <h2>–¢–µ—Å—Ç –æ–∑–≤—É—á—É–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å</h2>
        <input type="text" id="message-input" placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è" value="–¢–µ—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è">
        <select id="message-lang-select">
            <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
            <option value="en">English</option>
            <option value="crh">–ö—Ä–∏–º—Å—å–∫–æ—Ç–∞—Ç–∞—Ä—Å—å–∫–∞</option>
            <option value="nl">Nederlands</option>
        </select>
        <button onclick="testMessageSpeech()">–û–∑–≤—É—á–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</button>
        <div id="message-speech-status" class="status"></div>
    </div>

    <div class="test-section">
        <h2>–î–æ—Å—Ç—É–ø–Ω—ñ –≥–æ–ª–æ—Å–∏</h2>
        <button onclick="showAvailableVoices()">–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ –≥–æ–ª–æ—Å–∏</button>
        <div id="voices-status" class="status"></div>
    </div>

    <div class="test-section">
        <h2>–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≥–æ–ª–æ—Å—ñ–≤</h2>
        <div>
            <label>–ú–æ–≤–∞:</label>
            <select id="voice-lang-select">
                <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
                <option value="en">English</option>
                <option value="crh">–ö—Ä–∏–º—Å—å–∫–æ—Ç–∞—Ç–∞—Ä—Å—å–∫–∞</option>
                <option value="nl">Nederlands</option>
            </select>
        </div>
        <div>
            <label>–ì–æ–ª–æ—Å:</label>
            <select id="voice-select">
                <option value="">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</option>
            </select>
        </div>
        <button onclick="setVoice()">–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –≥–æ–ª–æ—Å</button>
        <button onclick="testCurrentVoice()">–¢–µ—Å—Ç—É–≤–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω–∏–π –≥–æ–ª–æ—Å</button>
        <div id="voice-settings-status" class="status"></div>
    </div>

    <div class="test-section">
        <h2>–ö–µ—Ä—É–≤–∞–Ω–Ω—è –æ–∑–≤—É—á—É–≤–∞–Ω–Ω—è–º</h2>
        <button onclick="stopAllSpeech()">–ó—É–ø–∏–Ω–∏—Ç–∏ –≤—Å—ñ –æ–∑–≤—É—á—É–≤–∞–Ω–Ω—è</button>
        <div id="control-status" class="status"></div>
    </div>

    <script type="module">
        import { speakMove, speakGameMessage, stopSpeaking, isSpeechEnabled, initVoices, getMoveText, getAvailableVoices, getVoicesForLanguage, setVoiceForLanguage, getCurrentVoice } from './js/speech.js';

        // --- –î–æ–¥–∞—é –∞–≤—Ç–æ–ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—é –Ω–∞–ø—Ä—è–º–∫—ñ–≤ —É —Å–µ–ª–µ–∫—Ç–æ—Ä—ñ ---
        function localizeDirections() {
            const lang = document.getElementById('lang-select').value;
            const dirSelect = document.getElementById('direction-select');
            Array.from(dirSelect.options).forEach(opt => {
                opt.textContent = opt.value + ' - ' + (opt.getAttribute('data-' + lang) || opt.getAttribute('data-uk'));
            });
        }
        document.getElementById('lang-select').addEventListener('change', localizeDirections);
        localizeDirections();
        // --- end ---

        window.checkSpeechSupport = function() {
            const statusDiv = document.getElementById('speech-support-status');
            const supported = isSpeechEnabled();
            
            if (supported) {
                statusDiv.className = 'status success';
                statusDiv.textContent = '‚úÖ Web Speech API –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è';
                initVoices();
            } else {
                statusDiv.className = 'status error';
                statusDiv.textContent = '‚ùå Web Speech API –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è';
            }
        };

        window.testMoveSpeech = function() {
            const direction = document.getElementById('direction-select').value;
            const distance = document.getElementById('distance-select').value;
            const lang = document.getElementById('lang-select').value;
            const statusDiv = document.getElementById('move-speech-status');
            
            try {
                const text = getMoveText(direction, distance, lang);
                statusDiv.className = 'status info';
                statusDiv.textContent = `üîä –û–∑–≤—É—á—É—î—Ç—å—Å—è: "${text}"`;
                
                speakMove(direction, distance, lang);
            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = `‚ùå –ü–æ–º–∏–ª–∫–∞: ${error.message}`;
            }
        };

        window.testMessageSpeech = function() {
            const message = document.getElementById('message-input').value;
            const lang = document.getElementById('message-lang-select').value;
            const statusDiv = document.getElementById('message-speech-status');
            
            try {
                statusDiv.className = 'status info';
                statusDiv.textContent = `üîä –û–∑–≤—É—á—É—î—Ç—å—Å—è: "${message}"`;
                
                speakGameMessage(message, lang);
            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = `‚ùå –ü–æ–º–∏–ª–∫–∞: ${error.message}`;
            }
        };

        window.showAvailableVoices = function() {
            const statusDiv = document.getElementById('voices-status');
            
            try {
                const voices = getAvailableVoices();
                if (voices.length === 0) {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = '‚ùå –ì–æ–ª–æ—Å–∏ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ';
                    return;
                }
                
                let html = '<h4>–î–æ—Å—Ç—É–ø–Ω—ñ –≥–æ–ª–æ—Å–∏:</h4><ul>';
                voices.forEach(voice => {
                    html += `<li><strong>${voice.name}</strong> (${voice.lang})${voice.default ? ' - –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º' : ''}</li>`;
                });
                html += '</ul>';
                
                statusDiv.className = 'status info';
                statusDiv.innerHTML = html;
            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = `‚ùå –ü–æ–º–∏–ª–∫–∞: ${error.message}`;
            }
        };

        window.setVoice = function() {
            const lang = document.getElementById('voice-lang-select').value;
            const voiceName = document.getElementById('voice-select').value;
            const statusDiv = document.getElementById('voice-settings-status');
            
            try {
                const success = setVoiceForLanguage(lang, voiceName);
                if (success) {
                    statusDiv.className = 'status success';
                    statusDiv.textContent = `‚úÖ –ì–æ–ª–æ—Å –¥–ª—è ${lang} –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ: ${voiceName}`;
                } else {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = '‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –≥–æ–ª–æ—Å';
                }
            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = `‚ùå –ü–æ–º–∏–ª–∫–∞: ${error.message}`;
            }
        };

        window.testCurrentVoice = function() {
            const lang = document.getElementById('voice-lang-select').value;
            const statusDiv = document.getElementById('voice-settings-status');
            
            try {
                const currentVoice = getCurrentVoice(lang);
                if (currentVoice) {
                    statusDiv.className = 'status info';
                    statusDiv.textContent = `üîä –¢–µ—Å—Ç—É—î–º–æ –≥–æ–ª–æ—Å: ${currentVoice.name} (${currentVoice.lang})`;
                    speakGameMessage(`–¢–µ—Å—Ç –≥–æ–ª–æ—Å—É –¥–ª—è ${lang}`, lang);
                } else {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = '‚ùå –ì–æ–ª–æ—Å –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ';
                }
            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = `‚ùå –ü–æ–º–∏–ª–∫–∞: ${error.message}`;
            }
        };

        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É –≥–æ–ª–æ—Å—ñ–≤
        function updateVoiceSelect() {
            const lang = document.getElementById('voice-lang-select').value;
            const voiceSelect = document.getElementById('voice-select');
            const voices = getVoicesForLanguage(lang);
            const currentVoice = getCurrentVoice(lang);
            
            voiceSelect.innerHTML = '';
            voices.forEach(voice => {
                const option = document.createElement('option');
                option.value = voice.name;
                option.textContent = `${voice.name} (${voice.lang})`;
                option.selected = currentVoice && currentVoice.name === voice.name;
                voiceSelect.appendChild(option);
            });
        }

        window.stopAllSpeech = function() {
            const statusDiv = document.getElementById('control-status');
            
            try {
                stopSpeaking();
                statusDiv.className = 'status success';
                statusDiv.textContent = '‚úÖ –í—Å—ñ –æ–∑–≤—É—á—É–≤–∞–Ω–Ω—è –∑—É–ø–∏–Ω–µ–Ω–æ';
            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = `‚ùå –ü–æ–º–∏–ª–∫–∞: ${error.message}`;
            }
        };

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –ø—ñ–¥—Ç—Ä–∏–º–∫—É –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
        document.addEventListener('DOMContentLoaded', function() {
            checkSpeechSupport();
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —Å–ø–∏—Å–æ–∫ –≥–æ–ª–æ—Å—ñ–≤ –ø—Ä–∏ –∑–º—ñ–Ω—ñ –º–æ–≤–∏
            const voiceLangSelect = document.getElementById('voice-lang-select');
            if (voiceLangSelect) {
                voiceLangSelect.addEventListener('change', updateVoiceSelect);
            }
            
            // –ü–æ—á–∞—Ç–∫–æ–≤–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É –≥–æ–ª–æ—Å—ñ–≤
            setTimeout(updateVoiceSelect, 1000);
        });
    </script>
</body>
</html> 